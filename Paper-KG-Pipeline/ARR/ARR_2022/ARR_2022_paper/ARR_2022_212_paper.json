{
  "name" : "ARR_2022_212_paper.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Parallel Decoding Sequences by Glancing Discrete Latent Variables",
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Non-autoregressive Transformer (NAT, Gu et al., 2018) introduce a parallel decoding paradigm with higher decoding efficiency (> 10×) than autoregressive models (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017). Unlike autoregressive models, NAT models impose conditional independence assumptions in words to support parallel decoding of sentences during inference. It attracts many researchers to explore NAT in machine translation (Gu et al., 2018; Lee et al., 2018; Kaiser et al., 2018) and text-to-speech tasks (Chen et al., 2019; Peng et al., 2020).\nAmount of researchers devoted themselves to improve the NATs’ generation quality. Such as modeling word inter-dependencies by curriculum learning (Guo et al., 2020a; Liu et al., 2020) or iterative refinements mechanism (Ghazvininejad et al., 2019; Guo et al., 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al., 2019; Ma et al., 2019; Bao et al., 2021), or introduce inductive bias for NAT\nmodels’ training (Wei et al., 2019; Li et al., 2019). The most successful method is the glancing transformer (GLAT, Qian et al., 2021a), which trains the NAT model by sampling partial target words as inputs to predict the remaining words, explicitly building dependencies between the observed and unobserved words. Qian et al. (2021b) employ GLAT to achieve a fantastic result, even outperforming many strong autoregressive translation systems in BLEU score (Papineni et al., 2002) on the German-English translation task of WMT211.\nAlthough they achieve competitive results compared to autoregressive models in translation tasks, we observe that they still need the help of an autoregressive Transformer (AT, Vaswani et al., 2017) as a teacher for training, i.e., sequence-level knowledge distillation (Kim and Rush, 2016). Zhou et al. (2020); Sun and Yang (2020) point out that the multi-modality phenomenon, namely, each input may have multiple valid outputs in datasets, preventing NAT models from learning to organize consistent outputs. Training with the outputs of an AT can alleviate the multi-modality problem by filtering the training set.\nHowever, training NAT models with an AT model is quite limited. Including knowledge distillation via an AT model significantly enlarges the training cost due to its extra training time. Besides, the AT models may not be accurate enough in other text generation settings except machine translation, which will become the bottleneck for its student NAT model. Therefore, training a model from scratch without an AT model is an open and exciting challenge.\nIn this paper, we propose mix-GLT, which can directly learn from the raw dataset. To overcome the multi-modality problem, we follow a divideand-conquer spirit, introducing a small set of discrete latent variables to divide the origin goal into latent variable modeling and sentence modeling.\n1http://statmt.org/wmt21/\nEach latent variable sequence discretized from sentence are information to determine the mode of the sentence, which effectively reduces the multimodality problem at the sentence level. Also, these latent variables will have fewer modes than origin sentences, namely, fewer multi-modality phenomena, which can be modeled with a glancing transformer (Qian et al., 2021a) directly. Finally, we extend glancing training with the latent variables to model the sentence, encouraging the model to build dependencies on latent variables rather than specific words, which works more robust.\nWe conduct experiments on various text generation tasks, including machine translation, paraphrase generation, and dialog generation. Experiments results show that mix-GLT achieves remarkable improvements over several strong baselines, verify the effectiveness of mix-GLT. In-depth analyses and ablation studies indicate that the introduced latent variables and glancing training are necessary for performance improvement."
    }, {
      "heading" : "2 Parallel Decoding in Sequence Models",
      "text" : "A sequence-to-sequence model aims to parameterize p(Y|X ), which defines the probability of target sentence Y = (y1, y2, · · · , ym) given input sentence X = (x1, x2, · · · , xn), where n and m are the sentence lengths.\nDozens of researches (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017) factorize p(Y|X ) with a series of conditional probability:\npAT(Y|X ) = m∏ t=1 p(yt|y<t,X ), (1)\nwhere y<t = (y1, y2, · · · , yt−1). Such autoregressive factorization predicts words2 based on its history predictions, which exists the risk of exposure bias and slow decoding during inference.\nNon-autoregressive Transformer. To tackle the above problems, Gu et al. (2018) firstly propose non-autoregressive Transformer (NAT), removing y<t and factorizing p(Y|X ) as:\npNAT(Y|X ) = m∏ t=1 p(yt|X ), (2)\nwhere each word yt are modeled independently. During inference, NAT model decodes a sentence\n2We use BPE segmentation in our experiments, and they are strictly tokens. For clarity, we use words and tokens interchangeably in the paper.\nby argmaxyt p(yt|X ) for each position t, remarkably improving the efficiency (15× speedups).\nHowever, the efficiency improvements of NAT are at the cost of its quality, e.g., the performance degradation by more than 10.0 BLEU (Papineni et al., 2002) points in machine translation tasks (Gu et al., 2018). The independence assumption prevents the NAT model from leveraging the inherent word dependencies to organize consistent outputs.\nGlancing Transformer. Qian et al. (2021a) propose Glancing Transformer (GLAT), which introduces glancing training (GLT) and trains NAT predictions with:\nLGLT = − log p(Yobs|Yobs,X ) = − ∑\nyi∈Yobs\nlog p(yi|Yobs,X ), (3)\nwhere Yobs is the partial target tokens, and Yobs is its complements set.\nDuring training, GLT samples Yobs according to the model’s prediction: sample fewer target words for well-predicted cases and sample more words for worse-predicted cases. Moreover, it progressively decreases the sampling ratio and obtains better performances in machine translation tasks.\nNevertheless, we experimentally find that GLAT still has a multi-modal problem3: First, the sampling rate cannot be reduced too small during training; otherwise, the performance will be close to the NAT model. Second, it still needs a teacher model for further improvements (Qian et al., 2021a).\nLatent Transformer. Kaiser et al. (2018); Shu et al. (2019); Ma et al. (2019); Bao et al. (2021) propose Latent Transformer (LT), introducing latent variables z for NAT predictions as:\npLT(Y|X ) = ∫ z p(z|X ) · m∏ t=1 p(yt|z,X ). (4)\nAs observed, LT models first predict the latent variables with p(z|X ), then simultaneously decode the sentence by argmaxyt p(yt|z,X ).\nIn practice, LT models are always trained by variational inference (Shu et al., 2019; Ma et al., 2019) or discretization techniques (Kaiser et al., 2018; Bao et al., 2021). Such latent variables are decomposed from the target sentence, which is informative to determine the mode of the sentence and alleviates the multi-modality problems.\n3We include details of GLAT in Appendix A\nAlthough LT models improve performance in terms of BLEU score, the used autoregressive predictor (Kaiser et al., 2018; Bao et al., 2021) or deep iterative transformation (Shu et al., 2019; Ma et al., 2019) for predicting latent variables unavoidable sacrifice the overall decoding efficiency. In addition, they do not explicitly build the interdependencies among the outputs.\n3 Proposed Method: mix-GLT\nIn this section, we present mix-GLT in detail. mixGLT follows Latent Transformer models (Kaiser et al., 2018; Bao et al., 2021) but introduces glancing training (Qian et al., 2021a) with the discrete latent variables. Our intuitions are as follows:\nAs aforementioned in Section §2, we can decompose the original multi-modal targets with a small set of latent variables. The decomposed latent variables are informative to determine the mode of the sentence and alleviate its multi-modality issues. In such a case, we can incorporate glancing training to directly model the reduced-modality target sentences based on the latent variables."
    }, {
      "heading" : "3.1 Model Structure",
      "text" : "In this part, we state the structure of mix-GLT, which introduces a small set of discrete latent variables for a NAT model, basically following Kaiser et al. (2018); Roy et al. (2018); Bao et al. (2021).\nLet K be the size of the discrete latent space and let [K] denote the set {1, 2, · · · ,K}. For each target sentence Y = (y1, y2, · · · , ym), we use a same-length latent variable sequence for modeling it as:\np(Y|X ) = ∑ z pθ(z|X ) · m∏ t=1 pθ(yt|z,X ), (5)\nwhere z = (z1, z2, · · · , zm) and zi ∈ [K], θ is the model parameters.\nMaximizing the log-likelihood of Eqn. (5) is unpractical due to its exponential searching spaces and complex decoding process. Therefore, we follow Kaiser et al. (2018) and adopt a discretization technique to train the model.\nFor discretizing target sentences to latent variables, we use vector quantization (Roy et al., 2018), which works by dividing a large set of origin vector representations into small groups. Specifically, we assign each token yi with a group j ∈ [K] that has the nearest distance to its representation:\nzi = argmin j∈[K]\n|| repr(yi)− qj ||2, (6)\nMix. Decoder\ny1 y3 y4y2\nNAT Predictor\nz1 z3 z4z2\nA tt\nen tio\nn\n+ + + +\nV ec to r\nQ ua\nnt iz at io n\nz1 z4\n+ + + +\nMix. Decoder\ny1 y3 h4h2\ny3y2y1 y4 Attention\nG la\nnc in g\nNAT Encoder\ne1 e2 e3\nx1 x3x2\nA tt\nen tio\nn\nSoftcopy\nh3h2z1 z4\nNAT Predictor\nz3z2z1 z4\nG\nla\nnc in\ng\nAttention\nwhere q ∈ RK×D is the maintained representations and D is its dimension, and we use the embedding as repr(yi), refer to Bao et al. (2021). Then, the model is trained to minimize\nL = Lrec + β‖ repr(yi)− sg(qzi)‖ (7)\nwhere Lrec is the prediction loss for Y and z, and sg(·) is the stop gradient operator.\nThe maintained representations q are updated with an exponential moving average over a minibatch of target tokens {y1, · · · , yi, · · · }:\ncj ← λcj + (1− λ) ∑ i 1[zi = j],\nqj ← λqj + (1− λ) ∑ i 1[zi = j] repr(yi) cj (8)\nwhere cj is assigned count for group j, and we set decay parameter λ = 0.999 in our experiments.\nArchitecture. As shown in Figure 1a, mix-GLT mainly consists of an encoder Fenc (NAT Encoder), a latent predictor FLP (NAT Predictor), and a decoder Fdec (Mix. Decoder). We parameterize them with the multi-head attention-based encoder or decoder, similar to Transformer (Vaswani et al., 2017). We formalize their functions as:\n(e1, e2, · · · , en)← Fenc(x1, x2, · · · , xn), (h1, h2, · · · , hm)← softcopy(e1:n),\npθ(z|X )← FLP(h1:m, e1:n), pθ(Y|z,X )← Fdec(z1:m, h1:m, e1:n),\n(9)\nwhere we use an extra module Flen to predict the target length m and initialize the decoder inputs\nH = (h1, h2, · · · , hm) with the softcopy (Wei et al., 2019) mechanism."
    }, {
      "heading" : "3.2 Training by Glancing Latent Variables",
      "text" : "As our design, the discretized latent variables will have fewer modes than raw sentences, which can be trained directly without the help of distillation. Notably, we model the latent variable sequence in a non-autoregressive fashion, in which we use a glancing training technique (Qian et al., 2021a) for optimizing it, as shown in Figure 1b:\nLLP = − log pθ(zobs|zobs,X ) (10)\nwhere zobs is uniformly sampled from z, refer to Qian et al. (2021a). We provide more details for glancing training with mix-GLT in Appendix B\nOur next insight is modeling the sentence using the sampled latent variables zobs rather than z, as we cannot predict the z exactly during inference:\nLGSZ = − log pθ(Y|zobs,X ). (11)\nWe experimentally find Eqn. (11) works robustly and analyze it in Section (§ 4.3).\nAs shown in Figure 1c, we eventually employ glancing training with target token for optimizing LGSZ, namely we optimize the Mix. Decoder by minimizing\nLMIX = − log pθ(Yobs|zobs,Yobs,X ), (12)\nwhere Yobs and zobs are the sampled target tokens and discrete latent variables.\nOverall Training Loss. Our full-fledged loss includes latent variable prediction, sentence reconstruction, and length prediction losses:\nL = LMIX + LLP + αLLEN, (13)\nwhere α = 0.1 are the hyperparameters to adjust the importance of length prediction loss LLEN."
    }, {
      "heading" : "3.3 Inference",
      "text" : "The inference process of mix-GLT includes length prediction, latent variables and sentence prediction.\nFor determining the target length, mix-GLT first predicts the target target length m with the length predictor. To avoid the length prediction errors during inference, mix-GLT expands the length m to a ranges (we use [m− 3, · · · ,m+ 2], total six candidates in our experiments).\nThen, mix-GLT predicts the latent variables ẑ with argmaxz pθ(z|X ) and sentence Ŷ with argmaxY pθ(Y|ẑ,X ) for each candidate length.\nLike Ma et al. (2019), mix-GLT ranks them by itself and chooses the highest score output with:\nŶ = argmax Y\npθ(Y|ẑ,X ) · γ|Y| (14)\nwhere γ is the length penalty ratio to avoid the length bias, and |Y| denotes the length of Y ."
    }, {
      "heading" : "4 Experiments",
      "text" : "We conduct experiments on several generation tasks, including machine translation, paraphrase, and dialog generation."
    }, {
      "heading" : "4.1 Experimental Setup",
      "text" : "Dataset. We chose the most popular benchmarks for each task:\n• Machine Translation (MT): We follow previous practices in NAT models and use the WMT14 English (EN)↔ German (DE) corpus (4.5M sentence pairs) and the IWSLT14 German (DE)→ English (EN) corpus (160K sentence pairs) to validate our proposed model. We obtain the datasets following the instruction open-sourced in fairseq4. In detail, we first tokenize the datasets with Moses script. Then, we use 37,000 and 10,000 operations to split the words into byte-pair encodings (BPE, Sennrich et al., 2016) in WMT14 and IWSLT14 datasets, respectively. We also share subword embeddings between the source and target language for each dataset. • Paraphrase Generation (PG): We use the Quora5 dataset to evaluate the paraphrase generation task. The Quora dataset contains around 135K labeled paraphrases pairs. Following the standard dataset split, we sample 100K sentence pairs from the labeled paraphrases as training data and hold out 30K pairs for testing, the remaining about 5K pairs for validation. Like the MT tasks, we tokenize the corpus with Moses scripts and split the words into BPE units with total 32K operations. • Dialog Generation (DG): We conduct the dialog generation experiments on the DailyDialog dataset (Li et al., 2017). We obtain the\n4https://github.com/pytorch/fairseq 5https://www.kaggle.com/c/\nquora-question-pairs/data\nprocessed DailyDialog dataset from Bao et al. (2020)6. The training set contains 87,170 sentence pairs (11,118 dialogues). The validation and testing set in the dataset contain 8069 pairs (1000 dialogues) and 7740 pairs (1000 dialogues), respectively.\nNote that these tasks emphasize different aspects. The task of MT aims to transfer bilingual sentences with semantically invariant conditions. The PG task differs from machine translation and works on mode transformation in the same language, whose goal is to synthesize a sentence different from the original input but conveys the same meaning. The DG task is most challenging due to the limited corpus and complex background.\nImplementations. We mainly compare mix-GLT with Transformer (Vaswani et al., 2017), vanilla NAT (Gu et al., 2018), and GLAT (Qian et al., 2021a) models. We implement them based on the open-source framework fairseq (Ott et al., 2019).\nFor machine translation tasks, we use the base setting (dmodel = 512, dhidden = 2048, dropout = 0.1, nhead = 8, and nlayer = 6) of Transformer (Vaswani et al., 2017) for WMT14 dataset and a smaller setting (dmodel = 512, dhidden = 1024, dropout = 0.3, nhead = 4, and nlayer = 6) for IWSLT14 dataset. The number of layers in mixGLT decoder and latent predictor are both set to 4 in experiments. We use inverse square root learning rate scheduling for WMT14 and a linear annealing learning rate from 3.0 × 10−4 to 1.0 × 10−5 in 250K steps for IWSLT14. The models are optimized with Adam (Kingma and Ba, 2015) optimizer (β1 = 0.9, β2 = 0.999) in 300K steps for WMT14 and 250K steps for IWSLT14. As for the ratio τ that used in glancing sampling, we linear anneal the ratio from 0.5 to 0.3 in whole training steps. The mini-batch in each step consists of 2K\n6https://github.com/gmftbyGMFTBY/ MultiTurnDialogZoo\ntokens for IWSLT14 and 64K tokens for WMT14. Since the scale of the Quora and DailyDialog datasets are close to the IWSLT14, we keep the same setting to the IWSLT14, such as the Adam, learning rate (linear annealing from 3.0× 10−4 to 1.0× 10−5), and batch size (2K tokens).\nEvaluation. To validate the effectiveness of our proposed method, we evaluate it in terms of quality and efficiency. We use tokenized and cased BLEU scores (Papineni et al., 2002)7 to evaluate the generation quality of MT and PG tasks. For dialog generation, we also include BLEU-1 and BLEU-2 scores for analysis. Following the common practices (Gu et al., 2018; Qian et al., 2021a), we measure the decoding latency of each model by decoding sentence by sentence and compute the speedup compared with the autoregressive Transformer (AT) model to reflect its decoding efficiency. We highlight the best NAT result."
    }, {
      "heading" : "4.2 Main Results",
      "text" : "We can see from Table 1 that our mix-GLT almost outperforms all the NAT baselines (NAT and GLAT) in generation quality on all tasks while keeping a competitive decoding speedup to the autoregressive counterpart.\nMachine Translation. As seen, without using an AT model as a teacher for training NAT models, the vanilla NAT and advanced GLAT model only obtain inferior generation quality. In contrast, mix-GLT achieves competitive generation quality in machine translation tasks, indicating that the introduced latent variables effectively reduce the multi-modality issue and support glancing training well. It narrows the performance gap between nonautoregressive decoding and autoregressive decoding from 11.46 (GLAT vs. AT) to 2.34 (mix-GLT vs. AT) BLEU points on WMT14 EN→DE task while keeping a high-speed decoding efficiency.\n7We evaluate it using fairseq_score script.\nParaphrasing. Unlike the translation task, the performance gap between non-autoregressive and autoregressive decoding on the paraphrase generation task is minor (NAT vs. AT, −3.32 BLEU points, GLAT vs. AT,−0.96 BLEU points ). Nevertheless, our introduced discrete latent variables still are helpful to obtain a better performance. mix-GLT realizes a non-autoregressive model with better performance than the autoregressive model on Quora dataset (mix-GLT vs. AT, +1.14 BLEU points).\nDialog Generation. We can see a different trend on the DailyDialog dataset — an AT model performs poorly than NAT models. Both GLAT and mix-GLT outperform the AT model in BLEU-1, BLEU-2, and BLEU scores, indicating that these models recall more reference tokens and organize the tokens well.\nWe conjecture that the weak and indirect association between the inputs and outputs of the dialogue encourages the AT model to predict the tokens by paying more attention to their history outputs. Finally, it may collapse into a target-side language model. In contrast, the NAT models do not have this fast track, pushing them to pay more attention to the inputs and recall more target tokens. We further find that there are so-called safe response (Li et al., 2016) in AT’s outputs, which verify our conjecture.\nMore Comparisons. we further compare the advanced NAT models that builds upon latent vari-\nables or iterative refinement in machine translation tasks:\n• NATs w/ latent variables: LV-NAR (Shu et al., 2019), SynST (Akoury et al., 2019), Flowseq (Ma et al., 2019), and CNAT (Bao et al., 2021). • Iterative NATs: CMLM (Ghazvininejad et al., 2019) and LevT (Gu et al., 2019).\nIt is shown in Table 2 that introducing latent variables (LV-NAR, Flowseq, and CNAT) or decoding with multiple iterations (CMLM and LevT) both improve non-autoregressive decoding in translation quality. However, iterative refinements or deep transformations always sacrifice decoding efficiency. In contrast, the proposed mix-GLT outperforms all NAT models with a relatively low cost, keeping a competitive speedup over autoregressive Transformer (AT). Specifically, mix-GLT with onepass decoding narrows the performance gap to the AT from 5.87 BLEU points to 2.34 BLEU points on the WMT14 EN→DE test set.\nDecoding efficiency. We can see there is a tradeoff between the translation quality and decoding efficiency in Table 2. We thus present the scatter plot of different models in Figure 2, showing the trend of translation quality and decoding efficiency.\nAs seen, mix-GLT is located on the top-right of the baselines. It outperforms the baselines in the BLEU score if decoding speedup is fixed and in decoding speedup if the BLEU score is fixed."
    }, {
      "heading" : "4.3 Analysis",
      "text" : "mix-GLT largely alleviates the sentence-level multi-modal problem. Previous researches (Gu et al., 2018; Ma et al., 2019; Qian et al., 2021a; Bao et al., 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets. Therefore, we use the average gains from the knowledge distillation to reflect the ability of the NAT models to overcome this issue.\nAs seen in Table 3, the pure NAT models heavily rely on knowledge distillation. By introducing the target information with the latent variables (Flowseq and CNAT) or sampled tokens (GLAT), the NAT models improve its’ ability to overcome the multi-modality issue. Our proposed mix-GLT well combines the above two techniques. It obtains only 0.95 BLEU points average gains and validates our motivation.\nDiscrete latent variables have fewer modes than raw sentences. To validate our intuition that the introduced latent variables are easier to predict than tokens, we refer to Zhou et al. (2020) to compute\nthe complexity metrics on each dataset according to alignment relations. Specifically, we use the fast_align8 toolkit to align source input X and target outputs Y or discretized latent variable sequences z. Then, we compute the token-level complexity CTOK(d) and the sentence-level complexity CSEN(d) according to Zhou et al. (2020). These metrics can trivially understand as the number of valid candidates for each input.\nAs shown in Table 4, the latent variables have the lowest complexity in both token-level complexity and sentence-level complexity. In other words, predicting the latent variable sequences is effortless than predicting others, which is consistent with our intuition. Although we obtain a lower complexity dataset by filtering the datasets with an autoregressive model (AT outputs versus Raw outputs), they may introduce model error and need extra training for AT model. In contrast, the discrete latent variables are simple and informative enough to serve as a springboard for modeling target sentences.\nGlancing with latent variables improves the performance with a large margin. We can see in Table 5 that introducing latent variables both ob-\n8https://github.com/clab/fast_align\nK 8 16 32 64 128 256\nBLEU (%) 20.80 22.16 22.61 23.64 23.26 21.94 ACCz (%) 61.20 53.10 43.57 39.24 36.39 33.84\nTable 6: Performances of mix-GLT with different K on the WMT14 EN→DE valid set. We compute the accuracy (ACCz) of latent prediction by taking the discretized latent variables as reference.\n1 Alpha 0.60 0.70 0.80 0.90 1.00 1.10 1.20 BLEU on valid set 22.4 23.17 22.78 23.47 23.24 23.64 22.67 BLEU on test set 23.24 23.55 23.91 24.23 24.52 24.71 24.16\nNum of Codes 16 32 64 128 BLEU on valid set 17.64 20.61 23.64 22.86\nB L\nE U\nS co\nre\n21.0\n24.0\n27.0\nLength Penalty Ratio\n0.60 0.70 0.80 0.90 1.00 1.10 1.20\n24.16 24.7124.5224.2323.91\n23.5523.24\n22.67\n23.64 23.2423.47\n22.78 23.17\n22.40\nBLEU on valid set BLEU on test set\nB L\nE U\nS co\nre\n17.5\n20.0\n22.5\n25.0\nNumber of Latent Variables\n16 32 64 128\n22.86 23.64\n20.61\n17.64\nFigure 3: Performances of mix-GLT using different length penalty ratios on the WMT14 EN→DE valid set.\ntain performance gains to their counterpart (L#2 vs. L#1, +0.83 points, and L#4 vs. L#3, +1.69 points). As expected, the gains are largely improved while adopting the glancing training with discrete latent variables (L#5 vs. L#1, +9.75 points), which already outperforms glancing training with the reference token (L#5 vs. L#4, +3.55 points). Finally, we jointly perform glancing training with the reference tokens and discrete latent variables, achieving the best result (L#6 vs. L#1, +11.04 points).\nEffects of K and γ. As shown in Figure 3 and Table 6, we search the hyper-parameter of mix-GLT that the number of discrete latent variables and the length penalty ratio γ according to the validation performance. We notice that using more latent codes causes performance degradation during inference, in which the latent variables may degenerate to tokens and contains more prediction error during inference. The mix-GLT implemented with 64 latent variables and γ = 1.1 obtains the best result."
    }, {
      "heading" : "5 Related Work",
      "text" : "Gu et al. (2018) first propose a non-autoregressive Transformer (NAT) model for neural machine translation (NMT) and begin to explore parallel decoding. It abandons explicitly modeling word interdependencies to decode the tokens in parallel, significantly improving the inference speed. However, its translation quality is inferior to the Trans-\nformer (Vaswani et al., 2017). To alleviate this performance degradation, many researchers work to enhance word dependency modeling, including imitation learning (Wei et al., 2019; Li et al., 2019), curriculum learning (Guo et al., 2020a; Liu et al., 2020), iterative refinements (Lee et al., 2018; Ghazvininejad et al., 2019; Gu et al., 2019; Guo et al., 2020b), and a simplified autoregressive process (Sun et al., 2019). The most representative method is the glancing transformer model (Qian et al., 2021a), which adaptively and progressively samples partial tokens as inputs and predicts the remaining tokens, effectively establishing the dependencies between the sampled tokens and the remaining tokens. However, these models still rely on a teacher for training, which cannot directly learn the raw dataset that contains one-tomany multi-modality phenomenon.\nOur method introduces latent variables to NAT models, which are close to Kaiser et al. (2018); Shu et al. (2019); Ma et al. (2019); Akoury et al. (2019); Bao et al. (2021). These methods decompose the latent variables (hints) from the target sentence and divide the origin goal into two parts: modeling latent variables and modeling the target sentences based on latent variables. It implicitly overcomes the multi-modality phenomenon of target sentences because the latent variables can largely determine the mode of the sentence. However, these methods always model the latent variables with an autoregressive predictor, which naturally sacrifices the decoding efficiency.\nUnlike them, our approach models the discrete latent variables in a non-autoregressive fashion and extends glancing training with the discrete latent variables. As a result, mix-GLT accomplishes a competitive performance both in decoding efficiency and quality."
    }, {
      "heading" : "6 Conclusion",
      "text" : "We propose mix-GLT, which can be directly trained without the help of knowledge distillation. Specifically, we employ discrete latent variables to divide the NAT prediction to the latent variables modeling and sentence reconstruction tasks. Then, we learn each task with the glancing training and encourages the model to build dependencies on the latent variables, which have few modes and are informative to modeling the target sentences. Experiments results on several representative text generation tasks validate the effectiveness of that our mix-GLT."
    }, {
      "heading" : "A Details of GLAT",
      "text" : "We can see in Figure 1a that the performance of a GLAT model will degenerate to that of a NAT model while the sampling ratio annealing too small. In addition, introducing the knowledge distillation for training the GLAT model alleviates this issue (Figure 1b).\nB Structure Details of mix-GLT\nSoftcopy Inputs. mix-GLT uses Softcopy (Wei et al., 2019; Li et al., 2019) mechanism to obtain the inputs H = (h1, h2, · · · , hm) as:\nhi = n∑ i αij · ei,\nαij ∝ exp [−(i− j · n\nm )2],\n(1)\nwhere E = (e1, e2, · · · , en) is the contextual representation of X encoded by the NAT encoder.\nGlancing Training for Latent Predictor. With the decoder input H = h1:m and the discretized latent variable sequence z = z1:m, we adopt the glancing sampling technique for training the latent predictor in the following steps:\n• Predicting ẑ: mix-GLT predicts the latent variable sequence with its latent predictor: ẑ ← FLP(h1:m, e1:n).\n• Determining sample number Nz: Given z and ẑ, we compute the sampling number as:\nNz = τ ·Hamming(z, ẑ) (2)\nwhere τ is the sampling ratio decreasing in the training steps, and we use Hamming distance (Hamming, 1950) for measuring the prediction quality.\n• Glancing reference: The glancing reference zobs is obtained by random selecting Nz elements from reference sequence z.\n• Re-constructing inputs H ′: We construct H ′ by position-wise replacing the decoder input h1:m with zobs.\n• Updating Latent Predictor: With the H ′ as inputs, We then train the latent predictor to predict the unobserved references zobs.\nGlancing Training for Mix. Decoder. Glancing training for Mix. Decoder is largely follow the Qian et al. (2021a), except using extra latent variables as inputs. With the decoder input H = h1:m, the reference sentence Y , and the glancing latent variable sequence zobs, we train it in the following steps:\n• Predicting Ŷ: mix-GLT predicts the target sentences: Ŷ ← Fdec(zobs, h1:m, e1:n).\n• Determining sample number Ny: Given Y and Ŷ , we compute the sampling number Ny = τ ·Hamming(Y, Ŷ).\n• Glancing reference: The glancing reference Yobs is obtained by random selecting Ny tokens from reference sequence Y .\n• Re-constructing inputs H ′: H ′ is constructed by position-wise replacing the decoder input H with embedding of Yobs.\n• Updating Mix. Decoder: We then train the Mix. Decoder to predict the unobserved references Yobs, with the H ′ and zobs as inputs."
    } ],
    "references" : [ {
      "title" : "Syntactically supervised transformers for faster neural machine translation",
      "author" : [ "Nader Akoury", "Kalpesh Krishna", "Mohit Iyyer." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 1269–1281, Florence,",
      "citeRegEx" : "Akoury et al\\.,? 2019",
      "shortCiteRegEx" : "Akoury et al\\.",
      "year" : 2019
    }, {
      "title" : "Neural machine translation by jointly learning to align and translate",
      "author" : [ "Dzmitry Bahdanau", "Kyunghyun Cho", "Yoshua Bengio." ],
      "venue" : "3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015,",
      "citeRegEx" : "Bahdanau et al\\.,? 2015",
      "shortCiteRegEx" : "Bahdanau et al\\.",
      "year" : 2015
    }, {
      "title" : "PLATO: Pre-trained dialogue generation model with discrete latent variable",
      "author" : [ "Siqi Bao", "Huang He", "Fan Wang", "Hua Wu", "Haifeng Wang." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages 85–96, Online.",
      "citeRegEx" : "Bao et al\\.,? 2020",
      "shortCiteRegEx" : "Bao et al\\.",
      "year" : 2020
    }, {
      "title" : "Nonautoregressive translation by learning target categorical codes",
      "author" : [ "Yu Bao", "Shujian Huang", "Tong Xiao", "Dongqi Wang", "Xinyu Dai", "Jiajun Chen." ],
      "venue" : "arXiv preprint arXiv:2103.11405.",
      "citeRegEx" : "Bao et al\\.,? 2021",
      "shortCiteRegEx" : "Bao et al\\.",
      "year" : 2021
    }, {
      "title" : "Listen and fill in the missing letters: Non-autoregressive transformer for speech recognition",
      "author" : [ "Nanxin Chen", "Shinji Watanabe", "Jesús Villalba", "Najim Dehak." ],
      "venue" : "arXiv preprint arXiv:1911.04908.",
      "citeRegEx" : "Chen et al\\.,? 2019",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2019
    }, {
      "title" : "Convolutional sequence to sequence learning",
      "author" : [ "Jonas Gehring", "Michael Auli", "David Grangier", "Denis Yarats", "Yann N. Dauphin." ],
      "venue" : "Proceedings of the 34th International Conference on Machine Learning, ICML 2017, Sydney, NSW, Australia,",
      "citeRegEx" : "Gehring et al\\.,? 2017",
      "shortCiteRegEx" : "Gehring et al\\.",
      "year" : 2017
    }, {
      "title" : "Mask-predict: Parallel decoding of conditional masked language models",
      "author" : [ "Marjan Ghazvininejad", "Omer Levy", "Yinhan Liu", "Luke Zettlemoyer." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the",
      "citeRegEx" : "Ghazvininejad et al\\.,? 2019",
      "shortCiteRegEx" : "Ghazvininejad et al\\.",
      "year" : 2019
    }, {
      "title" : "Nonautoregressive neural machine translation",
      "author" : [ "Jiatao Gu", "James Bradbury", "Caiming Xiong", "Victor O.K. Li", "Richard Socher." ],
      "venue" : "6th International Conference on Learning Representations, ICLR 2018, Vancouver, BC, Canada, April 30",
      "citeRegEx" : "Gu et al\\.,? 2018",
      "shortCiteRegEx" : "Gu et al\\.",
      "year" : 2018
    }, {
      "title" : "Levenshtein transformer",
      "author" : [ "Jiatao Gu", "Changhan Wang", "Junbo Zhao." ],
      "venue" : "Advances in Neural Information Processing Systems 32: Annual Conference on Neural Information Processing Systems 2019, NeurIPS 2019, December 8-14, 2019, Vancou-",
      "citeRegEx" : "Gu et al\\.,? 2019",
      "shortCiteRegEx" : "Gu et al\\.",
      "year" : 2019
    }, {
      "title" : "Fine-tuning by curriculum learning for non-autoregressive neural machine translation",
      "author" : [ "Junliang Guo", "Xu Tan", "Linli Xu", "Tao Qin", "Enhong Chen", "Tie-Yan Liu." ],
      "venue" : "Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages",
      "citeRegEx" : "Guo et al\\.,? 2020a",
      "shortCiteRegEx" : "Guo et al\\.",
      "year" : 2020
    }, {
      "title" : "Jointly masked sequence-to-sequence model for nonautoregressive neural machine translation",
      "author" : [ "Junliang Guo", "Linli Xu", "Enhong Chen." ],
      "venue" : "Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages 376–385,",
      "citeRegEx" : "Guo et al\\.,? 2020b",
      "shortCiteRegEx" : "Guo et al\\.",
      "year" : 2020
    }, {
      "title" : "Error detecting and error correcting codes",
      "author" : [ "Richard W Hamming." ],
      "venue" : "The Bell system technical journal, 29(2):147–160.",
      "citeRegEx" : "Hamming.,? 1950",
      "shortCiteRegEx" : "Hamming.",
      "year" : 1950
    }, {
      "title" : "Fast decoding in sequence models using discrete latent variables",
      "author" : [ "Lukasz Kaiser", "Samy Bengio", "Aurko Roy", "Ashish Vaswani", "Niki Parmar", "Jakob Uszkoreit", "Noam Shazeer." ],
      "venue" : "Proceedings of the 35th International Conference on Machine Learning,",
      "citeRegEx" : "Kaiser et al\\.,? 2018",
      "shortCiteRegEx" : "Kaiser et al\\.",
      "year" : 2018
    }, {
      "title" : "Sequencelevel knowledge distillation",
      "author" : [ "Yoon Kim", "Alexander M. Rush." ],
      "venue" : "Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing, pages 1317–1327, Austin, Texas. Association for Computational Linguistics.",
      "citeRegEx" : "Kim and Rush.,? 2016",
      "shortCiteRegEx" : "Kim and Rush.",
      "year" : 2016
    }, {
      "title" : "Adam: A method for stochastic optimization",
      "author" : [ "Diederik P. Kingma", "Jimmy Ba." ],
      "venue" : "3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings.",
      "citeRegEx" : "Kingma and Ba.,? 2015",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2015
    }, {
      "title" : "Deterministic non-autoregressive neural sequence modeling by iterative refinement",
      "author" : [ "Jason Lee", "Elman Mansimov", "Kyunghyun Cho." ],
      "venue" : "Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing, pages 1173–",
      "citeRegEx" : "Lee et al\\.,? 2018",
      "shortCiteRegEx" : "Lee et al\\.",
      "year" : 2018
    }, {
      "title" : "A diversity-promoting objective function for neural conversation models",
      "author" : [ "Jiwei Li", "Michel Galley", "Chris Brockett", "Jianfeng Gao", "William B Dolan." ],
      "venue" : "Proceedings of the 2016 Conference of the North American Chapter of the Association for Computa-",
      "citeRegEx" : "Li et al\\.,? 2016",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2016
    }, {
      "title" : "DailyDialog: A manually labelled multi-turn dialogue dataset",
      "author" : [ "Yanran Li", "Hui Su", "Xiaoyu Shen", "Wenjie Li", "Ziqiang Cao", "Shuzi Niu." ],
      "venue" : "Proceedings of the Eighth International Joint Conference on Natural Language Processing (Volume 1: Long Pa-",
      "citeRegEx" : "Li et al\\.,? 2017",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2017
    }, {
      "title" : "Hint-based training",
      "author" : [ "Zhuohan Li", "Di He", "Fei Tian", "Tao Qin", "Liwei Wang", "Tie-Yan Liu" ],
      "venue" : null,
      "citeRegEx" : "Li et al\\.,? \\Q2019\\E",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2019
    }, {
      "title" : "Task-level curriculum learning for non-autoregressive neural machine translation",
      "author" : [ "Jinglin Liu", "Yi Ren", "Chen Zhang Xu Tan", "Tao Qin", "Zhou Zhao", "Tie-Yan Liu." ],
      "venue" : "AAAI.",
      "citeRegEx" : "Liu et al\\.,? 2020",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2020
    }, {
      "title" : "FlowSeq: Nonautoregressive conditional sequence generation with generative flow",
      "author" : [ "Xuezhe Ma", "Chunting Zhou", "Xian Li", "Graham Neubig", "Eduard Hovy." ],
      "venue" : "Proceedings of the 2019 Conference on Empirical Methods in Natural Language",
      "citeRegEx" : "Ma et al\\.,? 2019",
      "shortCiteRegEx" : "Ma et al\\.",
      "year" : 2019
    }, {
      "title" : "fairseq: A fast, extensible toolkit for sequence modeling",
      "author" : [ "Myle Ott", "Sergey Edunov", "Alexei Baevski", "Angela Fan", "Sam Gross", "Nathan Ng", "David Grangier", "Michael Auli." ],
      "venue" : "Proceedings of the 2019 Conference of the North American Chap-",
      "citeRegEx" : "Ott et al\\.,? 2019",
      "shortCiteRegEx" : "Ott et al\\.",
      "year" : 2019
    }, {
      "title" : "Bleu: a method for automatic evaluation of machine translation",
      "author" : [ "Kishore Papineni", "Salim Roukos", "Todd Ward", "WeiJing Zhu." ],
      "venue" : "Proceedings of the 40th Annual Meeting of the Association for Computational Linguistics, pages 311–318, Philadelphia,",
      "citeRegEx" : "Papineni et al\\.,? 2002",
      "shortCiteRegEx" : "Papineni et al\\.",
      "year" : 2002
    }, {
      "title" : "Non-autoregressive neural text-to-speech",
      "author" : [ "Kainan Peng", "Wei Ping", "Zhao Song", "Kexin Zhao." ],
      "venue" : "Proceedings of the 37th International Conference on Machine Learning, ICML 2020, 13-18 July 2020, Virtual Event, volume 119 of Proceedings of Ma-",
      "citeRegEx" : "Peng et al\\.,? 2020",
      "shortCiteRegEx" : "Peng et al\\.",
      "year" : 2020
    }, {
      "title" : "Glancing transformer for non-autoregressive neural machine translation",
      "author" : [ "Lihua Qian", "Hao Zhou", "Yu Bao", "Mingxuan Wang", "Lin Qiu", "Weinan Zhang", "Yong Yu", "Lei Li." ],
      "venue" : "ACL.",
      "citeRegEx" : "Qian et al\\.,? 2021a",
      "shortCiteRegEx" : "Qian et al\\.",
      "year" : 2021
    }, {
      "title" : "The volctrans glat system: Nonautoregressive translation meets wmt21",
      "author" : [ "Lihua Qian", "Yi Zhou", "Zaixiang Zheng", "Yaoming Zhu", "Zehui Lin", "Jiangtao Feng", "Shanbo Cheng", "Lei Li", "Mingxuan Wang", "Hao Zhou." ],
      "venue" : "arXiv",
      "citeRegEx" : "Qian et al\\.,? 2021b",
      "shortCiteRegEx" : "Qian et al\\.",
      "year" : 2021
    }, {
      "title" : "Towards a better understanding of vector quantized autoencoders",
      "author" : [ "Aurko Roy", "Ashish Vaswani", "Niki Parmar", "Arvind Neelakantan." ],
      "venue" : "arXiv.",
      "citeRegEx" : "Roy et al\\.,? 2018",
      "shortCiteRegEx" : "Roy et al\\.",
      "year" : 2018
    }, {
      "title" : "Neural machine translation of rare words with subword units",
      "author" : [ "Rico Sennrich", "Barry Haddow", "Alexandra Birch." ],
      "venue" : "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 1715–",
      "citeRegEx" : "Sennrich et al\\.,? 2016",
      "shortCiteRegEx" : "Sennrich et al\\.",
      "year" : 2016
    }, {
      "title" : "Latent-variable nonautoregressive neural machine translation with deterministic inference using a delta posterior",
      "author" : [ "Raphael Shu", "Jason Lee", "Hideki Nakayama", "Kyunghyun Cho." ],
      "venue" : "arXiv preprint arXiv:1908.07181.",
      "citeRegEx" : "Shu et al\\.,? 2019",
      "shortCiteRegEx" : "Shu et al\\.",
      "year" : 2019
    }, {
      "title" : "Fast structured decoding for sequence models",
      "author" : [ "Zhiqing Sun", "Zhuohan Li", "Haoqing Wang", "Di He", "Zi Lin", "Zhi-Hong Deng." ],
      "venue" : "Advances in Neural Information Processing Systems 32: Annual Conference on Neural Information Processing Systems",
      "citeRegEx" : "Sun et al\\.,? 2019",
      "shortCiteRegEx" : "Sun et al\\.",
      "year" : 2019
    }, {
      "title" : "An em approach to non-autoregressive conditional sequence generation",
      "author" : [ "Zhiqing Sun", "Yiming Yang." ],
      "venue" : "International Conference on Machine Learning, pages 9249–9258. PMLR.",
      "citeRegEx" : "Sun and Yang.,? 2020",
      "shortCiteRegEx" : "Sun and Yang.",
      "year" : 2020
    }, {
      "title" : "Attention is all you need",
      "author" : [ "Ashish Vaswani", "Noam Shazeer", "Niki Parmar", "Jakob Uszkoreit", "Llion Jones", "Aidan N. Gomez", "Lukasz Kaiser", "Illia Polosukhin." ],
      "venue" : "Advances in Neural Information Processing Systems 30: Annual Conference on Neural",
      "citeRegEx" : "Vaswani et al\\.,? 2017",
      "shortCiteRegEx" : "Vaswani et al\\.",
      "year" : 2017
    }, {
      "title" : "Imitation learning for nonautoregressive neural machine translation",
      "author" : [ "Bingzhen Wei", "Mingxuan Wang", "Hao Zhou", "Junyang Lin", "Xu Sun." ],
      "venue" : "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 1304–",
      "citeRegEx" : "Wei et al\\.,? 2019",
      "shortCiteRegEx" : "Wei et al\\.",
      "year" : 2019
    }, {
      "title" : "Understanding knowledge distillation in nonautoregressive machine translation",
      "author" : [ "Chunting Zhou", "Jiatao Gu", "Graham Neubig." ],
      "venue" : "8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30,",
      "citeRegEx" : "Zhou et al\\.,? 2020",
      "shortCiteRegEx" : "Zhou et al\\.",
      "year" : 2020
    }, {
      "title" : "2021a), except using extra latent vari",
      "author" : [ "Qian" ],
      "venue" : null,
      "citeRegEx" : "Qian,? \\Q2021\\E",
      "shortCiteRegEx" : "Qian",
      "year" : 2021
    } ],
    "referenceMentions" : [ {
      "referenceID" : 1,
      "context" : ", 2018) introduce a parallel decoding paradigm with higher decoding efficiency (> 10×) than autoregressive models (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017).",
      "startOffset" : 114,
      "endOffset" : 181
    }, {
      "referenceID" : 5,
      "context" : ", 2018) introduce a parallel decoding paradigm with higher decoding efficiency (> 10×) than autoregressive models (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017).",
      "startOffset" : 114,
      "endOffset" : 181
    }, {
      "referenceID" : 31,
      "context" : ", 2018) introduce a parallel decoding paradigm with higher decoding efficiency (> 10×) than autoregressive models (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017).",
      "startOffset" : 114,
      "endOffset" : 181
    }, {
      "referenceID" : 7,
      "context" : "It attracts many researchers to explore NAT in machine translation (Gu et al., 2018; Lee et al., 2018; Kaiser et al., 2018) and text-to-speech tasks (Chen et al.",
      "startOffset" : 67,
      "endOffset" : 123
    }, {
      "referenceID" : 15,
      "context" : "It attracts many researchers to explore NAT in machine translation (Gu et al., 2018; Lee et al., 2018; Kaiser et al., 2018) and text-to-speech tasks (Chen et al.",
      "startOffset" : 67,
      "endOffset" : 123
    }, {
      "referenceID" : 12,
      "context" : "It attracts many researchers to explore NAT in machine translation (Gu et al., 2018; Lee et al., 2018; Kaiser et al., 2018) and text-to-speech tasks (Chen et al.",
      "startOffset" : 67,
      "endOffset" : 123
    }, {
      "referenceID" : 9,
      "context" : "Such as modeling word inter-dependencies by curriculum learning (Guo et al., 2020a; Liu et al., 2020) or iterative refinements mechanism (Ghazvininejad et al.",
      "startOffset" : 64,
      "endOffset" : 101
    }, {
      "referenceID" : 19,
      "context" : "Such as modeling word inter-dependencies by curriculum learning (Guo et al., 2020a; Liu et al., 2020) or iterative refinements mechanism (Ghazvininejad et al.",
      "startOffset" : 64,
      "endOffset" : 101
    }, {
      "referenceID" : 6,
      "context" : ", 2020) or iterative refinements mechanism (Ghazvininejad et al., 2019; Guo et al., 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al.",
      "startOffset" : 43,
      "endOffset" : 90
    }, {
      "referenceID" : 10,
      "context" : ", 2020) or iterative refinements mechanism (Ghazvininejad et al., 2019; Guo et al., 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al.",
      "startOffset" : 43,
      "endOffset" : 90
    }, {
      "referenceID" : 28,
      "context" : ", 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al., 2019; Ma et al., 2019; Bao et al., 2021), or introduce inductive bias for NAT models’ training (Wei et al.",
      "startOffset" : 86,
      "endOffset" : 139
    }, {
      "referenceID" : 20,
      "context" : ", 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al., 2019; Ma et al., 2019; Bao et al., 2021), or introduce inductive bias for NAT models’ training (Wei et al.",
      "startOffset" : 86,
      "endOffset" : 139
    }, {
      "referenceID" : 3,
      "context" : ", 2020b), introducing latent variables serve as the springboard for parallel decoding (Shu et al., 2019; Ma et al., 2019; Bao et al., 2021), or introduce inductive bias for NAT models’ training (Wei et al.",
      "startOffset" : 86,
      "endOffset" : 139
    }, {
      "referenceID" : 32,
      "context" : ", 2021), or introduce inductive bias for NAT models’ training (Wei et al., 2019; Li et al., 2019).",
      "startOffset" : 62,
      "endOffset" : 97
    }, {
      "referenceID" : 18,
      "context" : ", 2021), or introduce inductive bias for NAT models’ training (Wei et al., 2019; Li et al., 2019).",
      "startOffset" : 62,
      "endOffset" : 97
    }, {
      "referenceID" : 22,
      "context" : "(2021b) employ GLAT to achieve a fantastic result, even outperforming many strong autoregressive translation systems in BLEU score (Papineni et al., 2002) on the German-English translation task of WMT211.",
      "startOffset" : 131,
      "endOffset" : 154
    }, {
      "referenceID" : 13,
      "context" : ", sequence-level knowledge distillation (Kim and Rush, 2016).",
      "startOffset" : 40,
      "endOffset" : 60
    }, {
      "referenceID" : 24,
      "context" : "Also, these latent variables will have fewer modes than origin sentences, namely, fewer multi-modality phenomena, which can be modeled with a glancing transformer (Qian et al., 2021a) directly.",
      "startOffset" : 163,
      "endOffset" : 183
    }, {
      "referenceID" : 1,
      "context" : "Dozens of researches (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017) factorize p(Y|X ) with a series of conditional probability:",
      "startOffset" : 21,
      "endOffset" : 88
    }, {
      "referenceID" : 5,
      "context" : "Dozens of researches (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017) factorize p(Y|X ) with a series of conditional probability:",
      "startOffset" : 21,
      "endOffset" : 88
    }, {
      "referenceID" : 31,
      "context" : "Dozens of researches (Bahdanau et al., 2015; Gehring et al., 2017; Vaswani et al., 2017) factorize p(Y|X ) with a series of conditional probability:",
      "startOffset" : 21,
      "endOffset" : 88
    }, {
      "referenceID" : 22,
      "context" : "0 BLEU (Papineni et al., 2002) points in machine translation tasks (Gu et al.",
      "startOffset" : 7,
      "endOffset" : 30
    }, {
      "referenceID" : 7,
      "context" : ", 2002) points in machine translation tasks (Gu et al., 2018).",
      "startOffset" : 44,
      "endOffset" : 61
    }, {
      "referenceID" : 24,
      "context" : "Second, it still needs a teacher model for further improvements (Qian et al., 2021a).",
      "startOffset" : 64,
      "endOffset" : 84
    }, {
      "referenceID" : 28,
      "context" : "In practice, LT models are always trained by variational inference (Shu et al., 2019; Ma et al., 2019) or discretization techniques (Kaiser et al.",
      "startOffset" : 67,
      "endOffset" : 102
    }, {
      "referenceID" : 20,
      "context" : "In practice, LT models are always trained by variational inference (Shu et al., 2019; Ma et al., 2019) or discretization techniques (Kaiser et al.",
      "startOffset" : 67,
      "endOffset" : 102
    }, {
      "referenceID" : 12,
      "context" : ", 2019) or discretization techniques (Kaiser et al., 2018; Bao et al., 2021).",
      "startOffset" : 37,
      "endOffset" : 76
    }, {
      "referenceID" : 3,
      "context" : ", 2019) or discretization techniques (Kaiser et al., 2018; Bao et al., 2021).",
      "startOffset" : 37,
      "endOffset" : 76
    }, {
      "referenceID" : 12,
      "context" : "Although LT models improve performance in terms of BLEU score, the used autoregressive predictor (Kaiser et al., 2018; Bao et al., 2021) or deep iterative transformation (Shu et al.",
      "startOffset" : 97,
      "endOffset" : 136
    }, {
      "referenceID" : 3,
      "context" : "Although LT models improve performance in terms of BLEU score, the used autoregressive predictor (Kaiser et al., 2018; Bao et al., 2021) or deep iterative transformation (Shu et al.",
      "startOffset" : 97,
      "endOffset" : 136
    }, {
      "referenceID" : 28,
      "context" : ", 2021) or deep iterative transformation (Shu et al., 2019; Ma et al., 2019) for predicting latent variables unavoidable sacrifice the overall decoding efficiency.",
      "startOffset" : 41,
      "endOffset" : 76
    }, {
      "referenceID" : 20,
      "context" : ", 2021) or deep iterative transformation (Shu et al., 2019; Ma et al., 2019) for predicting latent variables unavoidable sacrifice the overall decoding efficiency.",
      "startOffset" : 41,
      "endOffset" : 76
    }, {
      "referenceID" : 12,
      "context" : "mixGLT follows Latent Transformer models (Kaiser et al., 2018; Bao et al., 2021) but introduces glancing training (Qian et al.",
      "startOffset" : 41,
      "endOffset" : 80
    }, {
      "referenceID" : 3,
      "context" : "mixGLT follows Latent Transformer models (Kaiser et al., 2018; Bao et al., 2021) but introduces glancing training (Qian et al.",
      "startOffset" : 41,
      "endOffset" : 80
    }, {
      "referenceID" : 24,
      "context" : ", 2021) but introduces glancing training (Qian et al., 2021a) with the discrete latent variables.",
      "startOffset" : 41,
      "endOffset" : 61
    }, {
      "referenceID" : 26,
      "context" : "For discretizing target sentences to latent variables, we use vector quantization (Roy et al., 2018), which works by dividing a large set of origin vector representations into small groups.",
      "startOffset" : 82,
      "endOffset" : 100
    }, {
      "referenceID" : 31,
      "context" : "We parameterize them with the multi-head attention-based encoder or decoder, similar to Transformer (Vaswani et al., 2017).",
      "startOffset" : 100,
      "endOffset" : 122
    }, {
      "referenceID" : 32,
      "context" : "H = (h1, h2, · · · , hm) with the softcopy (Wei et al., 2019) mechanism.",
      "startOffset" : 43,
      "endOffset" : 61
    }, {
      "referenceID" : 24,
      "context" : "Notably, we model the latent variable sequence in a non-autoregressive fashion, in which we use a glancing training technique (Qian et al., 2021a) for optimizing it, as shown in Figure 1b:",
      "startOffset" : 126,
      "endOffset" : 146
    }, {
      "referenceID" : 17,
      "context" : "• Dialog Generation (DG): We conduct the dialog generation experiments on the DailyDialog dataset (Li et al., 2017).",
      "startOffset" : 98,
      "endOffset" : 115
    }, {
      "referenceID" : 31,
      "context" : "We mainly compare mix-GLT with Transformer (Vaswani et al., 2017), vanilla NAT (Gu et al.",
      "startOffset" : 43,
      "endOffset" : 65
    }, {
      "referenceID" : 7,
      "context" : ", 2017), vanilla NAT (Gu et al., 2018), and GLAT (Qian et al.",
      "startOffset" : 21,
      "endOffset" : 38
    }, {
      "referenceID" : 21,
      "context" : "We implement them based on the open-source framework fairseq (Ott et al., 2019).",
      "startOffset" : 61,
      "endOffset" : 79
    }, {
      "referenceID" : 31,
      "context" : "1, nhead = 8, and nlayer = 6) of Transformer (Vaswani et al., 2017) for WMT14 dataset and a smaller setting (dmodel = 512, dhidden = 1024, dropout = 0.",
      "startOffset" : 45,
      "endOffset" : 67
    }, {
      "referenceID" : 14,
      "context" : "The models are optimized with Adam (Kingma and Ba, 2015) optimizer (β1 = 0.",
      "startOffset" : 35,
      "endOffset" : 56
    }, {
      "referenceID" : 22,
      "context" : "We use tokenized and cased BLEU scores (Papineni et al., 2002)7 to evaluate the generation quality of MT and PG tasks.",
      "startOffset" : 39,
      "endOffset" : 62
    }, {
      "referenceID" : 7,
      "context" : "Following the common practices (Gu et al., 2018; Qian et al., 2021a), we measure the decoding latency of each model by decoding sentence by sentence and compute the speedup compared with the autoregressive Transformer (AT) model to reflect its decoding efficiency.",
      "startOffset" : 31,
      "endOffset" : 68
    }, {
      "referenceID" : 24,
      "context" : "Following the common practices (Gu et al., 2018; Qian et al., 2021a), we measure the decoding latency of each model by decoding sentence by sentence and compute the speedup compared with the autoregressive Transformer (AT) model to reflect its decoding efficiency.",
      "startOffset" : 31,
      "endOffset" : 68
    }, {
      "referenceID" : 16,
      "context" : "We further find that there are so-called safe response (Li et al., 2016) in AT’s outputs, which verify our conjecture.",
      "startOffset" : 55,
      "endOffset" : 72
    }, {
      "referenceID" : 28,
      "context" : "• NATs w/ latent variables: LV-NAR (Shu et al., 2019), SynST (Akoury et al.",
      "startOffset" : 35,
      "endOffset" : 53
    }, {
      "referenceID" : 0,
      "context" : ", 2019), SynST (Akoury et al., 2019), Flowseq (Ma et al.",
      "startOffset" : 15,
      "endOffset" : 36
    }, {
      "referenceID" : 20,
      "context" : ", 2019), Flowseq (Ma et al., 2019), and CNAT (Bao et al.",
      "startOffset" : 17,
      "endOffset" : 34
    }, {
      "referenceID" : 6,
      "context" : "• Iterative NATs: CMLM (Ghazvininejad et al., 2019) and LevT (Gu et al.",
      "startOffset" : 23,
      "endOffset" : 51
    }, {
      "referenceID" : 7,
      "context" : "Previous researches (Gu et al., 2018; Ma et al., 2019; Qian et al., 2021a; Bao et al., 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets.",
      "startOffset" : 20,
      "endOffset" : 92
    }, {
      "referenceID" : 20,
      "context" : "Previous researches (Gu et al., 2018; Ma et al., 2019; Qian et al., 2021a; Bao et al., 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets.",
      "startOffset" : 20,
      "endOffset" : 92
    }, {
      "referenceID" : 24,
      "context" : "Previous researches (Gu et al., 2018; Ma et al., 2019; Qian et al., 2021a; Bao et al., 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets.",
      "startOffset" : 20,
      "endOffset" : 92
    }, {
      "referenceID" : 3,
      "context" : "Previous researches (Gu et al., 2018; Ma et al., 2019; Qian et al., 2021a; Bao et al., 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets.",
      "startOffset" : 20,
      "endOffset" : 92
    }, {
      "referenceID" : 13,
      "context" : ", 2021) always utilize a Transformer model as a teacher for training NAT models, namely sequence-level knowledge distillation (Kim and Rush, 2016), which can directly reduces the sentence-level multi-modal phenomenon in datasets.",
      "startOffset" : 126,
      "endOffset" : 146
    }, {
      "referenceID" : 31,
      "context" : "However, its translation quality is inferior to the Transformer (Vaswani et al., 2017).",
      "startOffset" : 64,
      "endOffset" : 86
    }, {
      "referenceID" : 32,
      "context" : "To alleviate this performance degradation, many researchers work to enhance word dependency modeling, including imitation learning (Wei et al., 2019; Li et al., 2019), curriculum learning (Guo et al.",
      "startOffset" : 131,
      "endOffset" : 166
    }, {
      "referenceID" : 18,
      "context" : "To alleviate this performance degradation, many researchers work to enhance word dependency modeling, including imitation learning (Wei et al., 2019; Li et al., 2019), curriculum learning (Guo et al.",
      "startOffset" : 131,
      "endOffset" : 166
    }, {
      "referenceID" : 9,
      "context" : ", 2019), curriculum learning (Guo et al., 2020a; Liu et al., 2020), iterative refinements (Lee et al.",
      "startOffset" : 29,
      "endOffset" : 66
    }, {
      "referenceID" : 19,
      "context" : ", 2019), curriculum learning (Guo et al., 2020a; Liu et al., 2020), iterative refinements (Lee et al.",
      "startOffset" : 29,
      "endOffset" : 66
    }, {
      "referenceID" : 15,
      "context" : ", 2020), iterative refinements (Lee et al., 2018; Ghazvininejad et al., 2019; Gu et al., 2019; Guo et al., 2020b), and a simplified autoregressive process (Sun et al.",
      "startOffset" : 31,
      "endOffset" : 113
    }, {
      "referenceID" : 6,
      "context" : ", 2020), iterative refinements (Lee et al., 2018; Ghazvininejad et al., 2019; Gu et al., 2019; Guo et al., 2020b), and a simplified autoregressive process (Sun et al.",
      "startOffset" : 31,
      "endOffset" : 113
    }, {
      "referenceID" : 8,
      "context" : ", 2020), iterative refinements (Lee et al., 2018; Ghazvininejad et al., 2019; Gu et al., 2019; Guo et al., 2020b), and a simplified autoregressive process (Sun et al.",
      "startOffset" : 31,
      "endOffset" : 113
    }, {
      "referenceID" : 10,
      "context" : ", 2020), iterative refinements (Lee et al., 2018; Ghazvininejad et al., 2019; Gu et al., 2019; Guo et al., 2020b), and a simplified autoregressive process (Sun et al.",
      "startOffset" : 31,
      "endOffset" : 113
    }, {
      "referenceID" : 29,
      "context" : ", 2020b), and a simplified autoregressive process (Sun et al., 2019).",
      "startOffset" : 50,
      "endOffset" : 68
    }, {
      "referenceID" : 24,
      "context" : "The most representative method is the glancing transformer model (Qian et al., 2021a), which adaptively and progressively samples partial tokens as inputs and predicts the remaining tokens, effectively establishing the dependencies between the sampled tokens and the remaining tokens.",
      "startOffset" : 65,
      "endOffset" : 85
    } ],
    "year" : 0,
    "abstractText" : "Recently, parallel decoding of sentences has received widespread attention due to its success in decoding efficiency. Many advanced techniques are proposed to improve its inferior quality, such as curriculum learning or introducing latent variables. However, we observe that these techniques still need an autoregressive teacher to help the model overcome the one-to-many multi-modal phenomenon in the dataset, which enlarges the training costs. In this paper, we propose mix-GLT, which well combines the power of latent variable models and an advanced glancing training technique to alleviate the multi-modality problem. Experiments results on several representative text generation tasks show that our method is much better than the strong baselines and further improving the generality of the parallel decoding paradigm.",
    "creator" : null
  }
}