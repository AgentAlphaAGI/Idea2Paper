{
  "name" : "ACL_2017_554_paper.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Scalable Bayesian Learning of Recurrent Neural Networks for Language Modeling",
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Language modeling is a fundamental task, used for example to predict the next word or character in a text sequence given the context. Recently, recurrent neural networks (RNNs) have shown promising performance on this task (Mikolov et al., 2010; Sutskever et al., 2011). RNNs with Long Short-Term Memory (LSTM) units (Hochreiter and Schmidhuber, 1997) have emerged as a popular architecture, due to their representational power and effectiveness at capturing long-term dependencies.\nRNNs are usually trained via back-propagation through time (Werbos, 1990), using stochastic optimization methods such as stochastic gradient de-\nscent (SGD) (Robbins and Monro, 1951); stochastic methods of this type are particularly important for training with large data sets. However, this approach often provides a maximum a posteriori (MAP) estimate of model parameters. The MAP solution is a single point estimate, ignoring weight uncertainty (Blundell et al., 2015; HernándezLobato and Adams, 2015). Natural language often exhibits significant variability, and hence such a point estimate may make over-confident predictions on test data.\nTo alleviate overfitting RNNs, good regularization is known as a key factor to successful applications. In the neural network literature, Bayesian learning has been proposed as a principled method to impose regularization and incorporate model uncertainty (MacKay, 1992; Neal, 1995), by imposing prior distributions on model parameters. Due to the intractability of posterior distributions in neural networks, Hamiltonian Monte Carlo (HMC) (Neal, 1995) has been used to provide sample-based approximations to the true posterior. Despite the elegant theoretical property of asymptotic convergence to the true posterior, HMC and other conventional Markov Chain Monte Carlo methods are not scalable to large training sets.\nThis paper seeks to scale up Bayesian learning of RNNs to meet the challenge of the increasing amount of “big” sequential data in natural language processing, leveraging recent advances in stochastic gradient Markov Chain Monte Carlo (SG-MCMC) algorithms (Welling and Teh, 2011; Chen et al., 2014; Ding et al., 2014; Li et al., 2016a). Specifically, instead of training a single network, SG-MCMC is employed to train an ensemble of networks, where each network has its parameters drawn from a shared posterior distribution. This is implemented by adding additional gradient noise during training and utilizing model\naveraging when testing. This simple procedure has the following salutary properties for training neural networks: (i) When training, the injected noise encourages model-parameter trajectories to better explore the parameter space. This procedure was also empirically found effective in (Neelakantan et al., 2016). (ii) Model averaging when testing alleviates overfitting and hence improves generalization, transferring uncertainty in the learned model parameters to subsequent prediction. (iii) In theory, both asymptotic and non-asymptotic consistency properties of SG-MCMC methods in posterior estimation have been recently established to guarantee convergence (Chen et al., 2015a; Teh et al., 2016). (iv) SG-MCMC is scalable; it shares the same level of computational cost as SGD in training, by only requiring the evaluation of gradients on a small mini-batch. To the authors’ knowledge, RNN training using SG-MCMC has not been investigated previously, and is a contribution of this paper. We also perform extensive experiments on several natural language processing tasks, demonstrating the effectiveness of SG-MCMC for RNNs, including character/word-level language modeling, image captioning and sentence classification."
    }, {
      "heading" : "2 Related Work",
      "text" : "Several scalable Bayesian learning methods have been proposed recently for neural networks. These come in two broad categories: stochastic variational inference (Graves, 2011; Blundell et al., 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al., 2015; Li et al., 2016a). While prior work focuses on feed-forward neural networks, there has been little if any research reported for RNNs using SG-\nMCMC.\nDropout (Hinton et al., 2012; Srivastava et al., 2014) is a commonly used regularization method for training neural networks. Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b). Among them, naive dropout (Zaremba et al., 2014) can impose weight uncertainty only on encoding weights (those that connect input to hidden units) and decoding weights (those that connect hidden units to output), but not the recurrent weights (those that connect consecutive hidden states). It has been concluded that noise added in the recurrent connections leads to model instabilities, hence disrupting the RNN’s ability to model sequences.\nDropout has been recently shown to be a variational approximation technique in Bayesian learning (Gal and Ghahramani, 2016a; Kingma et al., 2015). Based on this, (Gal and Ghahramani, 2016b) proposed a new variant of dropout that can be successfully applied to recurrent layers, where the same dropout masks are shared along time for encoding, decoding and recurrent weights, respectively. Alternatively, we focus on SG-MCMC, which can be viewed as the Bayesian interpretation of dropout from the perspective of posterior sampling (Li et al., 2016b); this also allows imposition of model uncertainty on recurrent layers, enhancing performance. A comparison of naive dropout and SG-MCMC is illustrated in Fig. 1."
    }, {
      "heading" : "3 Recurrent Neural Networks",
      "text" : ""
    }, {
      "heading" : "3.1 RNN as Bayesian Predictive Models",
      "text" : "Consider data D = {D1, · · · ,DN}, where Dn , (Xn,Yn), with input Xn and output Yn. Our goal is to learn model parameters θ to best characterize the relationship from Xn to Yn, with corresponding data likelihood p(D|θ) =∏N n=1 p(Dn|θ). In Bayesian statistics, one sets a prior on θ via distribution p(θ). The posterior p(θ|D) ∝ p(θ)p(D|θ) reflects the belief concerning the model parameter distribution after observing the data. Given a test input X̃ (with missing output Ỹ), the uncertainty learned in training is transferred to prediction, yielding the posterior\npredictive distribution:\np(Ỹ|X̃,D)= ∫ θ p(Ỹ|X̃,θ)p(θ|D)dθ . (1)\nWhen the input is a sequence, RNNs may be used to parameterize the input-output relationship. Specifically, consider input sequence X = {x1, . . . ,xT }, where xt is the input data vector at time t. There is a corresponding hidden state vector ht at each time t, obtained by recursively applying the transition function ht = H(ht−1,xt) (specified in Section 3.2; see Fig. 1). The ouput Y differs depending on the application: a sequence {y1, . . . ,yT } in language modeling or a discrete label in sentence classification. In RNNs the corresponding decoding function is p(y|h), described in Section 3.3."
    }, {
      "heading" : "3.2 RNN Architectures",
      "text" : "The transition function H(·) can be implemented with a gated activation function, such as Long Short-Term Memory (LSTM) (Hochreiter and Schmidhuber, 1997) or a Gated Recurrent Unit (GRU) (Cho et al., 2014). Both the LSTM and GRU have been proposed to address the issue of learning long-term sequential dependencies.\nLong Short-Term Memory The LSTM architecture addresses the problem of learning longterm dependencies by introducing a memory cell, that is able to preserve the state over long periods of time. Specifically, each LSTM unit has a cell containing a state ct at time t. This cell can be viewed as a memory unit. Reading or writing the cell is controlled through sigmoid gates: input gate it, forget gate ft, and output gate ot. The hidden units ht are updated as\nit = σ(Wixt +Uiht−1 + bi) ,\nft = σ(Wfxt +Ufht−1 + bf ) ,\not = σ(Woxt +Uoht−1 + bo) ,\nc̃t = tanh(Wcxt +Ucht−1 + bc) ,\nct = ft ct−1 + it c̃t , ht = ot tanh(ct) ,\nwhere σ(·) denotes the logistic sigmoid function, and represents the element-wise matrix multiplication operator. W{i,f,o,c} are encoding weights, and U{i,f,o,c} are recurrent weights, as shown in Fig. 1. b{i,f,o,c} are bias terms.\nVariants Similar to the LSTM unit, the GRU also has gating units that modulate the flow of information inside the hidden unit. It has been shown that a GRU can achieve similar performance to an LSTM in sequence modeling (Chung et al., 2014). We specify the GRU in the Supplementary Material.\nThe LSTM can be extended to the bidirectional LSTM and multilayer LSTM. A bidirectional LSTM consists of two LSTMs that are run in parallel: one on the input sequence and the other on the reverse of the input sequence. At each time step, the hidden state of the bidirectional LSTM is the concatenation of the forward and backward hidden states. In multilayer LSTMs, the hidden state of an LSTM unit in layer ` is used as input to the LSTM unit in layer `+1 at the same time step."
    }, {
      "heading" : "3.3 Applications",
      "text" : "The proposed Bayesian framework can be applied to any RNN model; we focus on the following tasks to demonstrate the ideas.\nLanguage Modeling In word-level language modeling, the input to the network is a sequence of words, and the network is trained to predict the next word in the sequence with a softmax classifier. Specifically, for a length-T sequence, denote yt = xt+1 for t = 1, . . . , T − 1. x1 and yT are always set to a special START and END token, respectively. At each time t, there is a decoding function p(yt|ht) = softmax(Vht) to compute the distribution over words, where V are the decoding weights (the number of rows of V corresponds to the number of words/characters). We also extend this basic language model to consider other applications: (i) a character-level language model can be specified in a similar manner by replacing words with characters (Karpathy et al., 2016). (ii) Image captioning can be considered as a conditional language modeling problem, in which we learn a generative language model of the caption conditioned on an image (Vinyals et al., 2015).\nSentence Classification Sentence classification aims to assign a semantic category label y to a whole sentence X. This is usually implemented through applying the decoding function once at the end of sequence: p(y|hT ) = softmax(VhT ), where the final hidden state of a RNN hT is often considered as the summary of the sentence (here\nthe number of rows of V corresponds to the number of classes)."
    }, {
      "heading" : "4 Scalable Learning with SG-MCMC",
      "text" : ""
    }, {
      "heading" : "4.1 The Pitfall of Stochastic Optimization",
      "text" : "Typically there is no closed-form solution for the posterior p(θ|D), and traditional Markov Chain Monte Carlo (MCMC) methods (Neal, 1995) scale poorly for largeN . To ease the computational burden, stochastic optimization is often employed to find the MAP solution. This is equivalent to minimizing an objective of regularized loss function U(θ) that corresponds to a (non-convex) model of interest: θMAP = argminU(θ), U(θ) = − log p(θ|D). The expectation in (1) is approximated as:\np(Ỹ|X̃,D)= p(Ỹ|X̃,θMAP) . (2)\nThough simple and effective, this procedure largely loses the benefit of the Bayesian approach, because the uncertainty on weights is ignored. To more accurately approximate (1), we employ stochastic gradient (SG) MCMC (Welling and Teh, 2011)."
    }, {
      "heading" : "4.2 Large-scale Bayesian Learning",
      "text" : "The negative log-posterior is\nU(θ) , − log p(θ)− N∑ n=1 log p(Dn|θ). (3)\nIn optimization,E = − ∑N\nn=1 log p(Dn|θ) is typically referred to as the loss function, and R ∝ − log p(θ) as a regularizer.\nFor large N , stochastic approximations are often employed:\nŨt(θ),− log p(θ)− N\nM M∑ m=1 log p(Dim |θ), (4)\nwhere Sm = {i1, · · · , iM} is a random subset of the set {1, 2, · · · , N}, with M N . The gradient on this mini-batch is denoted as f̃t = ∇Ũt(θ), which is an unbiased estimate of the true gradient. The evaluation of (4) is cheap even when N is large, allowing one to efficiently collect a sufficient number of samples in large-scale Bayesian learning, {θs}Ss=1, where S is the number of samples (this will be specified later). These samples are used to construct a sample-based estimation to the expectation in (1):\nThe finite-time estimation errors of SG-MCMC methods are bounded (Chen et al., 2015a), which guarantees (5) is an unbiased estimate of (1) asymptotically under appropriate decreasing stepsizes."
    }, {
      "heading" : "4.3 SG-MCMC Algorithms",
      "text" : "SG-MCMC and stochastic optimization are parallel lines of work, designed for different purposes; their relationship has recently been revealed in the context of deep learning. The most basic SG-MCMC algorithm has been applied to Langevin dynamics, and is termed SGLD (Welling and Teh, 2011). To help convergence, a momentum term has been introduced in SGHMC (Chen et al., 2014), a “thermostat” has been devised in SGNHT (Ding et al., 2014) and preconditioners have been employed in pSGLD (Li et al., 2016a). These SG-MCMC algorithms often share similar characteristics with their counterpart approaches from the optimization literature such as the momentum SGD, Santa (Chen et al., 2016) and RMSprop/Adagrad (Tieleman and Hinton, 2012; Duchi et al., 2011). The interrelationships between SG-MCMC and optimization-based approaches are summarized in Table 1.\nSGLD Stochastic Gradient Langevin Dynamics (SGLD) (Welling and Teh, 2011) draws posterior samples, with updates\nθt = θt−1 − ηtf̃t−1 + √ 2ηtξt , (6)\nwhere ηt is the learning rate, and ξt ∼ N (0, Ip) is a standard Gaussian random vector. SGLD is the SG-MCMC analog to stochastic gradient descent (SGD), whose parameter updates are given by:\nθt = θt−1 − ηtf̃t−1 . (7)\nSGD is guaranteed to converge to a local minimum under mild conditions (Bottou, 2010). The\nAlgorithm 1: pSGLD Input: Default hyperparameter settings:\nηt = 1×10−3, λ = 10−8, β1 = 0.99. Initialize: v0 ← 0, θ1 ∼ N (0, I) ; for t = 1, 2, . . . , T do\n% Estimate gradient from minibatch St f̃t = ∇Ũt(θ); % Preconditioning vt ← β1vt−1 + (1− β1)f̃t f̃t;\nG−1t ← diag ( 1 ( λ1+ v 1 2 t )) ;\n% Parameter update ξt ∼ N (0, ηtG−1t ); θt+1← θt + ηt2 G −1 t f̃t+ ξt;\nend\nadditional Gaussian term in SGLD helps the learning trajectory to explore the parameter space to approximate posterior samples, instead of obtaining a local minimum.\npSGLD Preconditioned SGLD (pSGLD) (Li et al., 2016a) was proposed recently to improve the mixing of SGLD. It utilizes magnitudes of recent gradients to construct a diagonal preconditioner to approximate the Fisher information matrix, and thus adjusts to the local geometry of parameter space by equalizing the gradients so that a constant stepsize is adequate for all dimensions. This is important for RNNs, whose parameter space often exhibits pathological curvature and saddle points (Pascanu et al., 2013), resulting in slow mixing. There are multiple choices of preconditioners; similar ideas in optimization include Adagrad (Duchi et al., 2011), Adam (Kingma and Ba, 2015) and RMSprop (Tieleman and Hinton, 2012). An efficient version of pSGLD, adopting RMSprop as the preconditioner G, is summarized in Algorithm 1, where denotes elementwise matrix division. When the preconditioner is fixed as the identity matrix, the method reduces to SGLD."
    }, {
      "heading" : "4.4 Understanding SG-MCMC",
      "text" : "To further understand SG-MCMC, we show its close connection to dropout/dropConnect (Srivastava et al., 2014; Wan et al., 2013). These methods improve the generalization ability of deep models, by randomly adding binary/Gaussian noise to the local units or global weights. For neural networks with the nonlinear function q(·) and consecutive\nlayers h1 and h2, dropout and dropConnect are denoted as:\nDropout: h2 = ξ0 q(θh1), DropConnect: h2 = q((ξ0 θ)h1),\nwhere the injected noise ξ0 can be binary-valued with dropping rate p or its equivalent Gaussian form (Wang and Manning, 2013):\nBinary noise: ξ0 ∼ Ber(p),\nGaussian noise: ξ0 ∼ N (1, p\n1− p ).\nNote that ξ0 is defined as a vector for dropout, and a matrix for dropConnect. By combining dropConnect and Gaussian noise from the above, we have the update rule (Li et al., 2016b):\nθt+1 = ξ0 θt − η\n2 f̃t = θt −\nη 2 f̃t + ξ ′ 0 , (8)\nwhere ξ′0 ∼ N ( 0, p(1−p)diag(θ 2 t ) )\n; (8) shows that dropout/ dropConnect and SGLD in (6) share the same form of update rule, with the distinction being that the level of injected noise is different. In practice, the noise injected by SGLD may not be enough. A better way that we find to improve the performance is to jointly apply SGLD and dropout. This method can be interpreted as using SGLD to sample the posterior distribution of a mixture of RNNs, with mixture probability controlled by the dropout rate."
    }, {
      "heading" : "5 Experiments",
      "text" : "We present results on several tasks, including character/ word-level language modeling, image captioning, and sentence classification. The hyperparameter settings, the initialization of model parameters and model specifications on each dataset are provided in the Supplementary Material.\nWe do not perform any dataset-specific tuning other than early stopping on validation sets. When dropout is utilized, the dropout rate is set to 0.5. All experiments are implemented in Theano (Theano Development Team, 2016), using a NVIDIA GeForce GTX TITAN X GPU with 12GB memory."
    }, {
      "heading" : "5.1 Language Modeling",
      "text" : "We first test character-level and word-level language modeling. The setup for each task is as follows.\n• Following (Karpathy et al., 2016), we test character-level language modeling on the War and Peace (WP) novel. The training/validation/test sets contain 260/32/33 batches, in which there are 100 characters. The vocabulary size is 87, and we consider a 2-hidden-layer RNN of dimension 128.\n• The Penn Treebank (PTB) corpus (Marcus et al., 1993) is used for word-level language modeling. The dataset adopts the standard split (929K training words, 73K validation words, and 82K test words) and has a vocabulary of size 10K. We train LSTMs of three sizes; these are denoted the small/medium/large LSTM. All LSTMs have two layers and are unrolled for 20 steps. The small, medium and large LSTM has 200, 650 and 1500 units per layer, respectively.\nWe study the effects of different types of architecture (LSTM/GRU/Vanilla RNN (Karpathy et al., 2016)) on the WP dataset, and effects of different learning algorithms on the PTB dataset. The comparison of test cross-entropy loss on WP is shown in Table 2. We observe that pSGLD consistently outperforms RMSprop. Table 3 summarizes the test set performance on PTB1. It is clear that our sampling-based method consistently outperforms the optimization counterpart, where the performance gain mainly comes from adding gradient noise and model averaging. When compared with dropout, SGLD performs better on the small LSTM model, but slightly worse on the medium and large LSTM model. This may imply that dropout is suitable to regularizing large networks, while SGLD exhibits better regularization ability on small networks, partially due to the fact that dropout may inject a higher level of noise during training than SGLD. In order to inject a higher level of noise into SGLD, we empirically apply SGLD and dropout jointly, and found that this provided the best performace on the medium and large LSTM model.\nWe study three strategies to do model averaging, i.e., forward collection, backward collection and thinned collection. Given samples (θ1, · · · ,θK) and the number of samples S used for averaging, forward collection refers to using (θ1, · · · ,θS) for\n1The results reported here do not match (Zaremba et al., 2014) due to the differences of experimental setup. However, we provide a fair comparison to all methods.\nthe evaluation of a test function, backward collection refers to using (θK−S+1, · · · ,θK), while thinned collection chooses samples from θ1 to θK with interval K/S. Fig. 2 plots the effects of these strategies, where Fig. 2(a) plots the perplexity of every single sample, Fig. 2(b) plots the perplexities using the three schemes. Only after 20 samples is a converged perplexity achieved in the thinned collection, while it requires 30 samples for forward collection or 60 samples for backward collection. This is unsurprising, because thinned collection provides a better way to select samples. Nevertheless, averaging of samples provides significantly lower perplexity than using single samples. Note that the overfitting problem in Fig. 2(a) is also alleviated by model averaging.\nTo better illustrate the benefit of model averaging, we visualize in Fig. 3 the probabilities of each word in a randomly chosen test sentence. The first 3 rows are the results predicted by 3 distinctive model samples, respectively; the bottom row is the result after averaging. Their corresponding perplexities for the test sentence are also shown on the right of each row. The 3 individual samples provide reasonable probabilities. For example, the consecutive words “New York”, “stock exchange” and “did not” are assigned with a higher probability. After averaging, we can see a much lower perplexity, as the samples can complement each other. For example, though the second sample can\n25.55the new york stock exchange did not fall apart 22.24the new york stock exchange did not fall apart 29.83the new york stock exchange did not fall apart\n21.98the new york stock exchange did not fall apart 0\n0.2\n0.4\n0.6\n0.8\nFigure 3: Predictive probabilities obtained by 3 samples and their average. Colors indicate normalized probability of each word. Best viewed in color.\na\"tan\"dog\"is\"playing\"in\"the\"grass a\"tan\"dog\"is\"playing\"with\"a\"red\"ball\"in\"the\"grass a\"tan\"dog\"with\"a\"red\"collar\"is\"running\"in\"the\"grass\na\"yellow\"dog\"runs\"through\"the\"grass a\"yellow\"dog\"is\"running\"through\"the\"grass a\"brown\"dog\"is\"running\"through\"the\"grass\na\"group\"of\"people\"stand\"in\"front\"of\"a\"building a\"group\"of\"people\"stand\"in\"front\"of\"a\"white\"building a\"group\"of\"people\"stand\"in\"front\"of\"a\"large\"building\na\"man\"and\"a\"woman\"walking\"on\"a\"sidewalk a\"man\"and\"a\"woman\"stand\"on\"a\"balcony a\"man\"and\"a\"woman\"standing\"on\"the\"ground\nFigure 4: Image captioning with different samples. Left are the given images, right are the corresponding captions. The captions in each box are from the same model sample.\nyield the lowest single-model perplexity, its prediction on word “York” is still benefited from the other two via averaging."
    }, {
      "heading" : "5.2 Image Caption Generation",
      "text" : "We next consider the problem of image caption generation, which is a conditional RNN model, where image features are extracted by residual network (He et al., 2016), and then fed into the RNN to generate the caption. We present results on two benchmark datasets, Flickr8k (Hodosh et al., 2013) and Flickr30k (Young et al., 2014). These datasets contain 8,000 and 31,000 images, respectively. Each image is annotated with 5 sentences. A single-layer LSTM is employed with the number of hidden units set to 512.\nThe widely used BLEU (Papineni et al., 2002),\nMETEOR (Banerjee and Lavie, 2005), ROUGEL (Lin, 2004), and CIDEr-D (Vedantam et al., 2015) metrics are used to evaluate the performance. All the metrics are computed by using the code released by the COCO evaluation server (Chen et al., 2015b).\nTable 4 presents results for pSGLD/RMSprop with or without dropout. Consistent with the results in the basic language modeling, pSGLD yields improved performance compared to RMSprop. For example, pSGLD provides 2.77 BLEU-4 score improvement over RMSprop on the Flickr8k dataset. By comparing pSGLD with RMSprop with dropout, we conclude that pSGLD exhibits better regularization ability than dropout on these two datasets.\nApart from modeling weight uncertainty, different samples from our algorithm may capture different aspects of the input image. An example with two images is shown in Fig. 4, where 2 randomly chosen model samples are considered for each image. For each model sample, the top 3 generated captions are presented. We use the beam search approach (Vinyals et al., 2015) to generate captions, with a beam of size 5. In Fig. 4, the two samples for the first image mainly differ in the color and activity of the dog, e.g., “tan” or “yellow”, “playing” or “running”, whereas for the second image, the two samples reflect different understanding of the image content."
    }, {
      "heading" : "5.3 Sentence Classification",
      "text" : "We study the task of sentence classification on 5 datasets as in (Kiros et al., 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al., 2005). A singlelayer bidirectional LSTM is employed with the\nTable 5: Sentence classification errors on five benchmark datasets.\nMethods MR CR SUBJ MPQA TREC RMSprop 21.26±1.45 22.70±2.20 8.13±1.19 10.60±1.28 8.58±0.79 RMSprop + Dropout 20.33±0.67 20.70±2.22 7.24±0.86 10.66±0.74 7.82±0.66 RMSprop + Gal’s Dropout 19.66±0.60 20.21±2.34 7.52±1.17 10.59±1.12 8.32±0.52 pSGLD 20.36±1.09 21.18±1.90 7.43±1.21 10.54±0.99 7.88±0.72 pSGLD + Dropout 19.48±0.95 19.74±2.03 6.61±1.06 10.22±0.89 7.32±0.66\n5 10 15 #Epoch\n0.00\n0.05\n0.10\n0.15\n0.20\n0.25\nEr ro\nr\nTrain RMSprop RMSprop + Dropout pSGLD pSGLD + Dropout\n5 10 15 #Epoch\n0.10\n0.12\n0.14\n0.16\n0.18\n0.20\n0.22\n0.24\n0.26\nEr ro\nr\nValidation\n5 10 15 #Epoch\n0.10\n0.15\n0.20\nEr ro\nr\nTest\nFigure 5: Learning curves on TREC dataset.\nnumber of hidden units set to 400. Table 5 shows the testing classification errors. 10-fold cross-validation is used for evaluation on the first 4 datasets, while TREC has a pre-defined training/test split, and we run each algorithm 10 times on TREC. In addition to (naive) dropout, we further compare pSGLD with the Gal’s dropout, recently proposed in (Gal and Ghahramani, 2016b), which is shown to be applicable to recurrent layers. The combination of pSGLD and dropout consistently provides the lowest errors.\nIn the following, we focus on the analysis of TREC. Each sentence of TREC is a question, and the goal is to decide which topic type the question is most related to: location, human, numeric, abbreviation, entity or description. Fig. 5 plots the learning curves of different algorithms on the training, validation and testing sets of the TREC dataset. pSGLD and dropout have similar behavior: they explore the parameter space during learning, and thus coverge slower than RSMprop on the training dataset. However, the learned uncertainty alleviates overfitting and results in lower errors on the validation and testing datasets.\nTo further study the Bayesian nature of the proposed approach, in Fig. 6 we choose two testing sentences with high uncertainty (i.e., standard derivation in prediction) from the TREC dataset. Interestingly, after embedding to 2d-space with tSNE (Van der Maaten and Hinton, 2008), the two sentences correspond to points lying on the boundary of different classes. We use 20 model sam-\nples to estimate the prediction mean and standard derivation on the true type and predicted type. The classifier yields higher probability on the wrong types, associated with higher standard derivations. One can leverage the uncertainty information to make decisions: either manually make a human judgement when uncertainty is high, or automatically choose the one with lower standard derivations when both types exhibits similar prediction means. A more rigorous usage of the uncertainty information is left as future work."
    }, {
      "heading" : "6 Conclusion",
      "text" : "We propose a scalable Bayesian learning framework using SG-MCMC, to model weight uncertainty in recurrent neural networks. The learning framework is tested on several tasks, including language models, image caption generation and sentence classification. Our algorithm outperforms stochastic optimization algorithms, indicating the importance of learning weight uncertainty in recurrent neural networks. Our algorithm requires little additional computational overhead in training, and multiple times of forward-passing for model averaging in testing. Future works include improving the testing efficiency for the large-scale RNNs, via learning a single neural network that approximates the model averaging result (Korattikara et al., 2015)."
    } ],
    "references" : [ {
      "title" : "Meteor: An automatic metric for mt evaluation with improved correlation with human judgments",
      "author" : [ "Satanjeev Banerjee", "Alon Lavie." ],
      "venue" : "ACL workshop.",
      "citeRegEx" : "Banerjee and Lavie.,? 2005",
      "shortCiteRegEx" : "Banerjee and Lavie.",
      "year" : 2005
    }, {
      "title" : "On fast dropout and its applicability to recurrent networks",
      "author" : [ "J. Bayer", "C. Osendorfer", "D. Korhammer", "N. Chen", "S. Urban", "P. van der Smagt." ],
      "venue" : "arXiv:1311.0701 .",
      "citeRegEx" : "Bayer et al\\.,? 2013",
      "shortCiteRegEx" : "Bayer et al\\.",
      "year" : 2013
    }, {
      "title" : "Where to apply dropout in recurrent neural networks for handwriting recognition? In ICDAR",
      "author" : [ "T. Bluche", "C. Kermorvant", "J. Louradour" ],
      "venue" : null,
      "citeRegEx" : "Bluche et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Bluche et al\\.",
      "year" : 2015
    }, {
      "title" : "Weight uncertainty in neural networks",
      "author" : [ "C. Blundell", "J. Cornebise", "K. Kavukcuoglu", "D. Wierstra." ],
      "venue" : "ICML.",
      "citeRegEx" : "Blundell et al\\.,? 2015",
      "shortCiteRegEx" : "Blundell et al\\.",
      "year" : 2015
    }, {
      "title" : "Large-scale machine learning with stochastic gradient descent",
      "author" : [ "L Bottou." ],
      "venue" : "COMPSTAT .",
      "citeRegEx" : "Bottou.,? 2010",
      "shortCiteRegEx" : "Bottou.",
      "year" : 2010
    }, {
      "title" : "Bridging the gap between stochastic gradient MCMC and stochastic optimization",
      "author" : [ "C. Chen", "D. Carlson", "Z. Gan", "C. Li", "L. Carin." ],
      "venue" : "AISTATS.",
      "citeRegEx" : "Chen et al\\.,? 2016",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2016
    }, {
      "title" : "On the convergence of stochastic gradient MCMC algorithms with high-order integrators",
      "author" : [ "C. Chen", "N. Ding", "L. Carin." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Chen et al\\.,? 2015a",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2015
    }, {
      "title" : "Stochastic gradient Hamiltonian Monte Carlo",
      "author" : [ "T. Chen", "E.B. Fox", "C. Guestrin." ],
      "venue" : "ICML.",
      "citeRegEx" : "Chen et al\\.,? 2014",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2014
    }, {
      "title" : "Microsoft coco captions: Data collection and evaluation server",
      "author" : [ "Xinlei Chen", "Hao Fang", "Tsung-Yi Lin", "Ramakrishna Vedantam", "Saurabh Gupta", "Piotr Dollár", "C Lawrence Zitnick." ],
      "venue" : "arXiv:1504.00325 .",
      "citeRegEx" : "Chen et al\\.,? 2015b",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2015
    }, {
      "title" : "Learning phrase representations using RNN encoder-decoder for statistical machine translation",
      "author" : [ "K. Cho", "B. Van Merriënboer", "C. Gulcehre", "D. Bahdanau", "F. Bougares", "H. Schwenk", "Y. Bengio." ],
      "venue" : "EMNLP.",
      "citeRegEx" : "Cho et al\\.,? 2014",
      "shortCiteRegEx" : "Cho et al\\.",
      "year" : 2014
    }, {
      "title" : "Empirical evaluation of gated recurrent neural networks on sequence modeling",
      "author" : [ "J. Chung", "C. Gulcehre", "K. Cho", "Y. Bengio." ],
      "venue" : "arXiv:1412.3555 .",
      "citeRegEx" : "Chung et al\\.,? 2014",
      "shortCiteRegEx" : "Chung et al\\.",
      "year" : 2014
    }, {
      "title" : "Bayesian sampling using stochastic gradient thermostats",
      "author" : [ "N. Ding", "Y. Fang", "R. Babbush", "C. Chen", "R.D. Skeel", "H. Neven." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Ding et al\\.,? 2014",
      "shortCiteRegEx" : "Ding et al\\.",
      "year" : 2014
    }, {
      "title" : "Adaptive subgradient methods for online learning and stochastic optimization",
      "author" : [ "J. Duchi", "E. Hazan", "Y. Singer." ],
      "venue" : "JMLR .",
      "citeRegEx" : "Duchi et al\\.,? 2011",
      "shortCiteRegEx" : "Duchi et al\\.",
      "year" : 2011
    }, {
      "title" : "Dropout as a Bayesian approximation: Representing model uncertainty in deep learning",
      "author" : [ "Y. Gal", "Z. Ghahramani." ],
      "venue" : "ICML.",
      "citeRegEx" : "Gal and Ghahramani.,? 2016a",
      "shortCiteRegEx" : "Gal and Ghahramani.",
      "year" : 2016
    }, {
      "title" : "A theoretically grounded application of dropout in recurrent neural networks",
      "author" : [ "Y. Gal", "Z. Ghahramani." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Gal and Ghahramani.,? 2016b",
      "shortCiteRegEx" : "Gal and Ghahramani.",
      "year" : 2016
    }, {
      "title" : "Practical variational inference for neural networks",
      "author" : [ "A. Graves." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Graves.,? 2011",
      "shortCiteRegEx" : "Graves.",
      "year" : 2011
    }, {
      "title" : "Deep residual learning for image recognition",
      "author" : [ "Kaiming He", "Xiangyu Zhang", "Shaoqing Ren", "Jian Sun." ],
      "venue" : "CVPR.",
      "citeRegEx" : "He et al\\.,? 2016",
      "shortCiteRegEx" : "He et al\\.",
      "year" : 2016
    }, {
      "title" : "Probabilistic backpropagation for scalable learning of Bayesian neural networks",
      "author" : [ "J.M. Hernández-Lobato", "R.P. Adams." ],
      "venue" : "ICML.",
      "citeRegEx" : "Hernández.Lobato and Adams.,? 2015",
      "shortCiteRegEx" : "Hernández.Lobato and Adams.",
      "year" : 2015
    }, {
      "title" : "Improving neural networks by preventing co-adaptation of feature detectors",
      "author" : [ "G. Hinton", "N. Srivastava", "A. Krizhevsky", "I. Sutskever", "R Salakhutdinov." ],
      "venue" : "arXiv:1207.0580 .",
      "citeRegEx" : "Hinton et al\\.,? 2012",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2012
    }, {
      "title" : "Long shortterm memory",
      "author" : [ "S. Hochreiter", "J. Schmidhuber." ],
      "venue" : "Neural computation.",
      "citeRegEx" : "Hochreiter and Schmidhuber.,? 1997",
      "shortCiteRegEx" : "Hochreiter and Schmidhuber.",
      "year" : 1997
    }, {
      "title" : "Framing image description as a ranking task: Data, models and evaluation metrics",
      "author" : [ "M. Hodosh", "P. Young", "J. Hockenmaier." ],
      "venue" : "JAIR .",
      "citeRegEx" : "Hodosh et al\\.,? 2013",
      "shortCiteRegEx" : "Hodosh et al\\.",
      "year" : 2013
    }, {
      "title" : "Mining and summarizing customer reviews",
      "author" : [ "M. Hu", "B. Liu." ],
      "venue" : "SIGKDD .",
      "citeRegEx" : "Hu and Liu.,? 2004",
      "shortCiteRegEx" : "Hu and Liu.",
      "year" : 2004
    }, {
      "title" : "Visualizing and understanding recurrent networks",
      "author" : [ "A. Karpathy", "J. Johnson", "L. Fei-Fei." ],
      "venue" : "ICLR Workshop.",
      "citeRegEx" : "Karpathy et al\\.,? 2016",
      "shortCiteRegEx" : "Karpathy et al\\.",
      "year" : 2016
    }, {
      "title" : "Adam: A method for stochastic optimization",
      "author" : [ "D. Kingma", "J. Ba." ],
      "venue" : "ICLR.",
      "citeRegEx" : "Kingma and Ba.,? 2015",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2015
    }, {
      "title" : "Variational dropout and the local reparameterization trick",
      "author" : [ "D. Kingma", "T. Salimans", "M. Welling." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Kingma et al\\.,? 2015",
      "shortCiteRegEx" : "Kingma et al\\.",
      "year" : 2015
    }, {
      "title" : "Skip-thought vectors",
      "author" : [ "Ryan Kiros", "Yukun Zhu", "Ruslan Salakhutdinov", "Richard Zemel", "Raquel Urtasun", "Antonio Torralba", "Sanja Fidler." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Kiros et al\\.,? 2015",
      "shortCiteRegEx" : "Kiros et al\\.",
      "year" : 2015
    }, {
      "title" : "Bayesian dark knowledge",
      "author" : [ "A. Korattikara", "V. Rathod", "K. Murphy", "M. Welling." ],
      "venue" : "NIPS.",
      "citeRegEx" : "Korattikara et al\\.,? 2015",
      "shortCiteRegEx" : "Korattikara et al\\.",
      "year" : 2015
    }, {
      "title" : "Preconditioned stochastic gradient Langevin dynamics for deep neural networks",
      "author" : [ "C. Li", "C. Chen", "D. Carlson", "L. Carin." ],
      "venue" : "AAAI.",
      "citeRegEx" : "Li et al\\.,? 2016a",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2016
    }, {
      "title" : "Learning weight uncertainty with stochastic gradient MCMC for shape classification",
      "author" : [ "C. Li", "A. Stevens", "C. Chen", "Y. Pu", "Z. Gan", "L. Carin." ],
      "venue" : "CVPR.",
      "citeRegEx" : "Li et al\\.,? 2016b",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2016
    }, {
      "title" : "Learning question classifiers",
      "author" : [ "X. Li", "D. Roth." ],
      "venue" : "ACL .",
      "citeRegEx" : "Li and Roth.,? 2002",
      "shortCiteRegEx" : "Li and Roth.",
      "year" : 2002
    }, {
      "title" : "Rouge: A package for automatic evaluation of summaries",
      "author" : [ "Chin-Yew Lin." ],
      "venue" : "ACL workshop.",
      "citeRegEx" : "Lin.,? 2004",
      "shortCiteRegEx" : "Lin.",
      "year" : 2004
    }, {
      "title" : "A practical Bayesian framework for backpropagation networks",
      "author" : [ "D.J.C. MacKay." ],
      "venue" : "Neural computation.",
      "citeRegEx" : "MacKay.,? 1992",
      "shortCiteRegEx" : "MacKay.",
      "year" : 1992
    }, {
      "title" : "Building a large annotated corpus of english: The penn treebank",
      "author" : [ "M.P. Marcus", "M.A. Marcinkiewicz", "B. Santorini." ],
      "venue" : "Computational linguistics .",
      "citeRegEx" : "Marcus et al\\.,? 1993",
      "shortCiteRegEx" : "Marcus et al\\.",
      "year" : 1993
    }, {
      "title" : "Recurrent neural network based language model",
      "author" : [ "T. Mikolov", "M. Karafiát", "L. Burget", "J. Cernockỳ", "S. Khudanpur." ],
      "venue" : "INTERSPEECH.",
      "citeRegEx" : "Mikolov et al\\.,? 2010",
      "shortCiteRegEx" : "Mikolov et al\\.",
      "year" : 2010
    }, {
      "title" : "Rnndrop: A novel dropout for rnns in asr",
      "author" : [ "T. Moon", "H. Choi", "H. Lee", "I. Song." ],
      "venue" : "ASRU .",
      "citeRegEx" : "Moon et al\\.,? 2015",
      "shortCiteRegEx" : "Moon et al\\.",
      "year" : 2015
    }, {
      "title" : "Bayesian learning for neural networks",
      "author" : [ "R.M. Neal." ],
      "venue" : "PhD thesis, University of Toronto.",
      "citeRegEx" : "Neal.,? 1995",
      "shortCiteRegEx" : "Neal.",
      "year" : 1995
    }, {
      "title" : "Adding gradient noise improves learning for very deep networks",
      "author" : [ "A. Neelakantan", "L. Vilnis", "Q. Le", "I. Sutskever", "L. Kaiser", "K. Kurach", "J. Martens." ],
      "venue" : "ICLR workshop.",
      "citeRegEx" : "Neelakantan et al\\.,? 2016",
      "shortCiteRegEx" : "Neelakantan et al\\.",
      "year" : 2016
    }, {
      "title" : "Regularization and nonlinearities for neural language models: when are they needed",
      "author" : [ "M. Pachitariu", "M. Sahani" ],
      "venue" : null,
      "citeRegEx" : "Pachitariu and Sahani.,? \\Q2013\\E",
      "shortCiteRegEx" : "Pachitariu and Sahani.",
      "year" : 2013
    }, {
      "title" : "A sentimental education: Sentiment analysis using subjectivity summarization based on minimum cuts",
      "author" : [ "B. Pang", "L. Lee." ],
      "venue" : "ACL .",
      "citeRegEx" : "Pang and Lee.,? 2004",
      "shortCiteRegEx" : "Pang and Lee.",
      "year" : 2004
    }, {
      "title" : "Seeing stars: Exploiting class relationships for sentiment categorization with respect to rating scales",
      "author" : [ "B. Pang", "L. Lee." ],
      "venue" : "ACL .",
      "citeRegEx" : "Pang and Lee.,? 2005",
      "shortCiteRegEx" : "Pang and Lee.",
      "year" : 2005
    }, {
      "title" : "Bleu: a method for automatic evaluation of machine translation",
      "author" : [ "Kishore Papineni", "Salim Roukos", "Todd Ward", "WeiJing Zhu." ],
      "venue" : "ACL.",
      "citeRegEx" : "Papineni et al\\.,? 2002",
      "shortCiteRegEx" : "Papineni et al\\.",
      "year" : 2002
    }, {
      "title" : "On the difficulty of training recurrent neural networks",
      "author" : [ "R. Pascanu", "T. Mikolov", "Y. Bengio." ],
      "venue" : "ICML.",
      "citeRegEx" : "Pascanu et al\\.,? 2013",
      "shortCiteRegEx" : "Pascanu et al\\.",
      "year" : 2013
    }, {
      "title" : "Dropout improves recurrent neural networks for handwriting recognition",
      "author" : [ "V. Pham", "T. Bluche", "C. Kermorvant", "J. Louradour." ],
      "venue" : "ICFHR.",
      "citeRegEx" : "Pham et al\\.,? 2014",
      "shortCiteRegEx" : "Pham et al\\.",
      "year" : 2014
    }, {
      "title" : "A stochastic approximation method",
      "author" : [ "H. Robbins", "S. Monro." ],
      "venue" : "The annals of mathematical statistics.",
      "citeRegEx" : "Robbins and Monro.,? 1951",
      "shortCiteRegEx" : "Robbins and Monro.",
      "year" : 1951
    }, {
      "title" : "Recurrent dropout without memory loss",
      "author" : [ "S. Semeniuta", "A. Severyn", "E. Barth." ],
      "venue" : "arXiv:1603.05118 .",
      "citeRegEx" : "Semeniuta et al\\.,? 2016",
      "shortCiteRegEx" : "Semeniuta et al\\.",
      "year" : 2016
    }, {
      "title" : "Dropout: A simple way to prevent neural networks from overfitting",
      "author" : [ "N. Srivastava", "G. Hinton", "A. Krizhevsky", "I. Sutskever", "R. Salakhutdinov." ],
      "venue" : "JMLR .",
      "citeRegEx" : "Srivastava et al\\.,? 2014",
      "shortCiteRegEx" : "Srivastava et al\\.",
      "year" : 2014
    }, {
      "title" : "Generating text with recurrent neural networks",
      "author" : [ "I. Sutskever", "J. Martens", "G.E. Hinton." ],
      "venue" : "ICML.",
      "citeRegEx" : "Sutskever et al\\.,? 2011",
      "shortCiteRegEx" : "Sutskever et al\\.",
      "year" : 2011
    }, {
      "title" : "Consistency and fluctuations for stochastic gradient Langevin dynamics",
      "author" : [ "Y.W. Teh", "A.H. Thiéry", "S.J. Vollmer." ],
      "venue" : "JMLR .",
      "citeRegEx" : "Teh et al\\.,? 2016",
      "shortCiteRegEx" : "Teh et al\\.",
      "year" : 2016
    }, {
      "title" : "Theano: A Python framework for fast computation of mathematical expressions",
      "author" : [ "Theano Development Team." ],
      "venue" : "arXiv:1605.02688 .",
      "citeRegEx" : "Team.,? 2016",
      "shortCiteRegEx" : "Team.",
      "year" : 2016
    }, {
      "title" : "Lecture 6.5rmsprop: Divide the gradient by a running average of its recent magnitude. Coursera: Neural Networks for Machine Learning",
      "author" : [ "T. Tieleman", "G. Hinton" ],
      "venue" : null,
      "citeRegEx" : "Tieleman and Hinton.,? \\Q2012\\E",
      "shortCiteRegEx" : "Tieleman and Hinton.",
      "year" : 2012
    }, {
      "title" : "Visualizing data using t-SNE",
      "author" : [ "L. Van der Maaten", "G.E. Hinton." ],
      "venue" : "JMLR .",
      "citeRegEx" : "Maaten and Hinton.,? 2008",
      "shortCiteRegEx" : "Maaten and Hinton.",
      "year" : 2008
    }, {
      "title" : "Cider: Consensus-based image description evaluation",
      "author" : [ "Ramakrishna Vedantam", "C Lawrence Zitnick", "Devi Parikh." ],
      "venue" : "CVPR.",
      "citeRegEx" : "Vedantam et al\\.,? 2015",
      "shortCiteRegEx" : "Vedantam et al\\.",
      "year" : 2015
    }, {
      "title" : "Show and tell: A neural image caption generator",
      "author" : [ "O. Vinyals", "A. Toshev", "S. Bengio", "D. Erhan." ],
      "venue" : "CVPR.",
      "citeRegEx" : "Vinyals et al\\.,? 2015",
      "shortCiteRegEx" : "Vinyals et al\\.",
      "year" : 2015
    }, {
      "title" : "Regularization of neural networks using DropConnect",
      "author" : [ "L. Wan", "M. Zeiler", "S. Zhang", "Y. LeCun", "R. Fergus." ],
      "venue" : "ICML.",
      "citeRegEx" : "Wan et al\\.,? 2013",
      "shortCiteRegEx" : "Wan et al\\.",
      "year" : 2013
    }, {
      "title" : "Fast Dropout training",
      "author" : [ "S. Wang", "C. Manning." ],
      "venue" : "ICML.",
      "citeRegEx" : "Wang and Manning.,? 2013",
      "shortCiteRegEx" : "Wang and Manning.",
      "year" : 2013
    }, {
      "title" : "Bayesian learning via stochastic gradient Langevin dynamics",
      "author" : [ "M. Welling", "Y.W. Teh." ],
      "venue" : "ICML.",
      "citeRegEx" : "Welling and Teh.,? 2011",
      "shortCiteRegEx" : "Welling and Teh.",
      "year" : 2011
    }, {
      "title" : "Backpropagation through time: what it does and how to do it",
      "author" : [ "P. Werbos." ],
      "venue" : "Proceedings of the IEEE.",
      "citeRegEx" : "Werbos.,? 1990",
      "shortCiteRegEx" : "Werbos.",
      "year" : 1990
    }, {
      "title" : "Annotating expressions of opinions and emotions in language",
      "author" : [ "J. Wiebe", "T. Wilson", "C. Cardie." ],
      "venue" : "Language resources and evaluation .",
      "citeRegEx" : "Wiebe et al\\.,? 2005",
      "shortCiteRegEx" : "Wiebe et al\\.",
      "year" : 2005
    }, {
      "title" : "From image descriptions to visual denotations: New similarity metrics for semantic inference over event descriptions",
      "author" : [ "P. Young", "A. Lai", "M. Hodosh", "J. Hockenmaier." ],
      "venue" : "TACL .",
      "citeRegEx" : "Young et al\\.,? 2014",
      "shortCiteRegEx" : "Young et al\\.",
      "year" : 2014
    }, {
      "title" : "Recurrent neural network regularization",
      "author" : [ "W. Zaremba", "I. Sutskever", "O. Vinyals." ],
      "venue" : "arXiv:1409.2329 .",
      "citeRegEx" : "Zaremba et al\\.,? 2014",
      "shortCiteRegEx" : "Zaremba et al\\.",
      "year" : 2014
    } ],
    "referenceMentions" : [ {
      "referenceID" : 33,
      "context" : "Recently, recurrent neural networks (RNNs) have shown promising performance on this task (Mikolov et al., 2010; Sutskever et al., 2011).",
      "startOffset" : 89,
      "endOffset" : 135
    }, {
      "referenceID" : 46,
      "context" : "Recently, recurrent neural networks (RNNs) have shown promising performance on this task (Mikolov et al., 2010; Sutskever et al., 2011).",
      "startOffset" : 89,
      "endOffset" : 135
    }, {
      "referenceID" : 19,
      "context" : "RNNs with Long Short-Term Memory (LSTM) units (Hochreiter and Schmidhuber, 1997) have emerged as a popular architecture, due to their representational power and effectiveness at capturing long-term dependencies.",
      "startOffset" : 46,
      "endOffset" : 80
    }, {
      "referenceID" : 56,
      "context" : "RNNs are usually trained via back-propagation through time (Werbos, 1990), using stochastic optimization methods such as stochastic gradient descent (SGD) (Robbins and Monro, 1951); stochastic methods of this type are particularly important for training with large data sets.",
      "startOffset" : 59,
      "endOffset" : 73
    }, {
      "referenceID" : 43,
      "context" : "RNNs are usually trained via back-propagation through time (Werbos, 1990), using stochastic optimization methods such as stochastic gradient descent (SGD) (Robbins and Monro, 1951); stochastic methods of this type are particularly important for training with large data sets.",
      "startOffset" : 155,
      "endOffset" : 180
    }, {
      "referenceID" : 3,
      "context" : "The MAP solution is a single point estimate, ignoring weight uncertainty (Blundell et al., 2015; HernándezLobato and Adams, 2015).",
      "startOffset" : 73,
      "endOffset" : 129
    }, {
      "referenceID" : 31,
      "context" : "In the neural network literature, Bayesian learning has been proposed as a principled method to impose regularization and incorporate model uncertainty (MacKay, 1992; Neal, 1995), by imposing prior distributions on model parameters.",
      "startOffset" : 152,
      "endOffset" : 178
    }, {
      "referenceID" : 35,
      "context" : "In the neural network literature, Bayesian learning has been proposed as a principled method to impose regularization and incorporate model uncertainty (MacKay, 1992; Neal, 1995), by imposing prior distributions on model parameters.",
      "startOffset" : 152,
      "endOffset" : 178
    }, {
      "referenceID" : 35,
      "context" : "Due to the intractability of posterior distributions in neural networks, Hamiltonian Monte Carlo (HMC) (Neal, 1995) has been used to provide sample-based approximations to the true posterior.",
      "startOffset" : 103,
      "endOffset" : 115
    }, {
      "referenceID" : 55,
      "context" : "This paper seeks to scale up Bayesian learning of RNNs to meet the challenge of the increasing amount of “big” sequential data in natural language processing, leveraging recent advances in stochastic gradient Markov Chain Monte Carlo (SG-MCMC) algorithms (Welling and Teh, 2011; Chen et al., 2014; Ding et al., 2014; Li et al., 2016a).",
      "startOffset" : 255,
      "endOffset" : 334
    }, {
      "referenceID" : 7,
      "context" : "This paper seeks to scale up Bayesian learning of RNNs to meet the challenge of the increasing amount of “big” sequential data in natural language processing, leveraging recent advances in stochastic gradient Markov Chain Monte Carlo (SG-MCMC) algorithms (Welling and Teh, 2011; Chen et al., 2014; Ding et al., 2014; Li et al., 2016a).",
      "startOffset" : 255,
      "endOffset" : 334
    }, {
      "referenceID" : 11,
      "context" : "This paper seeks to scale up Bayesian learning of RNNs to meet the challenge of the increasing amount of “big” sequential data in natural language processing, leveraging recent advances in stochastic gradient Markov Chain Monte Carlo (SG-MCMC) algorithms (Welling and Teh, 2011; Chen et al., 2014; Ding et al., 2014; Li et al., 2016a).",
      "startOffset" : 255,
      "endOffset" : 334
    }, {
      "referenceID" : 27,
      "context" : "This paper seeks to scale up Bayesian learning of RNNs to meet the challenge of the increasing amount of “big” sequential data in natural language processing, leveraging recent advances in stochastic gradient Markov Chain Monte Carlo (SG-MCMC) algorithms (Welling and Teh, 2011; Chen et al., 2014; Ding et al., 2014; Li et al., 2016a).",
      "startOffset" : 255,
      "endOffset" : 334
    }, {
      "referenceID" : 36,
      "context" : "This procedure was also empirically found effective in (Neelakantan et al., 2016).",
      "startOffset" : 55,
      "endOffset" : 81
    }, {
      "referenceID" : 6,
      "context" : "(iii) In theory, both asymptotic and non-asymptotic consistency properties of SG-MCMC methods in posterior estimation have been recently established to guarantee convergence (Chen et al., 2015a; Teh et al., 2016).",
      "startOffset" : 174,
      "endOffset" : 212
    }, {
      "referenceID" : 47,
      "context" : "(iii) In theory, both asymptotic and non-asymptotic consistency properties of SG-MCMC methods in posterior estimation have been recently established to guarantee convergence (Chen et al., 2015a; Teh et al., 2016).",
      "startOffset" : 174,
      "endOffset" : 212
    }, {
      "referenceID" : 15,
      "context" : "These come in two broad categories: stochastic variational inference (Graves, 2011; Blundell et al., 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al.",
      "startOffset" : 69,
      "endOffset" : 140
    }, {
      "referenceID" : 3,
      "context" : "These come in two broad categories: stochastic variational inference (Graves, 2011; Blundell et al., 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al.",
      "startOffset" : 69,
      "endOffset" : 140
    }, {
      "referenceID" : 17,
      "context" : "These come in two broad categories: stochastic variational inference (Graves, 2011; Blundell et al., 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al.",
      "startOffset" : 69,
      "endOffset" : 140
    }, {
      "referenceID" : 26,
      "context" : ", 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al., 2015; Li et al., 2016a).",
      "startOffset" : 62,
      "endOffset" : 106
    }, {
      "referenceID" : 27,
      "context" : ", 2015; Hernández-Lobato and Adams, 2015) and SG-MCMC methods (Korattikara et al., 2015; Li et al., 2016a).",
      "startOffset" : 62,
      "endOffset" : 106
    }, {
      "referenceID" : 18,
      "context" : "Dropout (Hinton et al., 2012; Srivastava et al., 2014) is a commonly used regularization method for training neural networks.",
      "startOffset" : 8,
      "endOffset" : 54
    }, {
      "referenceID" : 45,
      "context" : "Dropout (Hinton et al., 2012; Srivastava et al., 2014) is a commonly used regularization method for training neural networks.",
      "startOffset" : 8,
      "endOffset" : 54
    }, {
      "referenceID" : 37,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 1,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 42,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 59,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 2,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 34,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 44,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 14,
      "context" : "Recently, several works have studied how to apply dropout to RNNs (Pachitariu and Sahani, 2013; Bayer et al., 2013; Pham et al., 2014; Zaremba et al., 2014; Bluche et al., 2015; Moon et al., 2015; Semeniuta et al., 2016; Gal and Ghahramani, 2016b).",
      "startOffset" : 66,
      "endOffset" : 247
    }, {
      "referenceID" : 59,
      "context" : "Among them, naive dropout (Zaremba et al., 2014) can impose weight uncertainty only on encoding weights (those that connect input to hidden units) and decoding weights (those that connect hidden units to output), but not the recurrent weights (those that connect consecutive hidden states).",
      "startOffset" : 26,
      "endOffset" : 48
    }, {
      "referenceID" : 13,
      "context" : "Dropout has been recently shown to be a variational approximation technique in Bayesian learning (Gal and Ghahramani, 2016a; Kingma et al., 2015).",
      "startOffset" : 97,
      "endOffset" : 145
    }, {
      "referenceID" : 24,
      "context" : "Dropout has been recently shown to be a variational approximation technique in Bayesian learning (Gal and Ghahramani, 2016a; Kingma et al., 2015).",
      "startOffset" : 97,
      "endOffset" : 145
    }, {
      "referenceID" : 14,
      "context" : "Based on this, (Gal and Ghahramani, 2016b) proposed a new variant of dropout that can be successfully applied to recurrent layers, where the same dropout masks are shared along time for encoding, decoding and recurrent weights, respectively.",
      "startOffset" : 15,
      "endOffset" : 42
    }, {
      "referenceID" : 28,
      "context" : "Alternatively, we focus on SG-MCMC, which can be viewed as the Bayesian interpretation of dropout from the perspective of posterior sampling (Li et al., 2016b); this also allows imposition of model uncertainty on recurrent layers, enhancing performance.",
      "startOffset" : 141,
      "endOffset" : 159
    }, {
      "referenceID" : 19,
      "context" : "The transition function H(·) can be implemented with a gated activation function, such as Long Short-Term Memory (LSTM) (Hochreiter and Schmidhuber, 1997) or a Gated Recurrent Unit (GRU) (Cho et al.",
      "startOffset" : 120,
      "endOffset" : 154
    }, {
      "referenceID" : 9,
      "context" : "The transition function H(·) can be implemented with a gated activation function, such as Long Short-Term Memory (LSTM) (Hochreiter and Schmidhuber, 1997) or a Gated Recurrent Unit (GRU) (Cho et al., 2014).",
      "startOffset" : 187,
      "endOffset" : 205
    }, {
      "referenceID" : 10,
      "context" : "It has been shown that a GRU can achieve similar performance to an LSTM in sequence modeling (Chung et al., 2014).",
      "startOffset" : 93,
      "endOffset" : 113
    }, {
      "referenceID" : 22,
      "context" : "We also extend this basic language model to consider other applications: (i) a character-level language model can be specified in a similar manner by replacing words with characters (Karpathy et al., 2016).",
      "startOffset" : 182,
      "endOffset" : 205
    }, {
      "referenceID" : 52,
      "context" : "(ii) Image captioning can be considered as a conditional language modeling problem, in which we learn a generative language model of the caption conditioned on an image (Vinyals et al., 2015).",
      "startOffset" : 169,
      "endOffset" : 191
    }, {
      "referenceID" : 35,
      "context" : "Typically there is no closed-form solution for the posterior p(θ|D), and traditional Markov Chain Monte Carlo (MCMC) methods (Neal, 1995) scale poorly for largeN .",
      "startOffset" : 125,
      "endOffset" : 137
    }, {
      "referenceID" : 55,
      "context" : "To more accurately approximate (1), we employ stochastic gradient (SG) MCMC (Welling and Teh, 2011).",
      "startOffset" : 76,
      "endOffset" : 99
    }, {
      "referenceID" : 6,
      "context" : "The finite-time estimation errors of SG-MCMC methods are bounded (Chen et al., 2015a), which guarantees (5) is an unbiased estimate of (1) asymptotically under appropriate decreasing stepsizes.",
      "startOffset" : 65,
      "endOffset" : 85
    }, {
      "referenceID" : 55,
      "context" : "The most basic SG-MCMC algorithm has been applied to Langevin dynamics, and is termed SGLD (Welling and Teh, 2011).",
      "startOffset" : 91,
      "endOffset" : 114
    }, {
      "referenceID" : 7,
      "context" : "To help convergence, a momentum term has been introduced in SGHMC (Chen et al., 2014), a “thermostat” has been devised in SGNHT (Ding et al.",
      "startOffset" : 66,
      "endOffset" : 85
    }, {
      "referenceID" : 11,
      "context" : ", 2014), a “thermostat” has been devised in SGNHT (Ding et al., 2014) and preconditioners have been employed in pSGLD (Li et al.",
      "startOffset" : 50,
      "endOffset" : 69
    }, {
      "referenceID" : 27,
      "context" : ", 2014) and preconditioners have been employed in pSGLD (Li et al., 2016a).",
      "startOffset" : 56,
      "endOffset" : 74
    }, {
      "referenceID" : 5,
      "context" : "These SG-MCMC algorithms often share similar characteristics with their counterpart approaches from the optimization literature such as the momentum SGD, Santa (Chen et al., 2016) and RMSprop/Adagrad (Tieleman and Hinton, 2012; Duchi et al.",
      "startOffset" : 160,
      "endOffset" : 179
    }, {
      "referenceID" : 55,
      "context" : "SGLD Stochastic Gradient Langevin Dynamics (SGLD) (Welling and Teh, 2011) draws posterior samples, with updates",
      "startOffset" : 50,
      "endOffset" : 73
    }, {
      "referenceID" : 4,
      "context" : "SGD is guaranteed to converge to a local minimum under mild conditions (Bottou, 2010).",
      "startOffset" : 71,
      "endOffset" : 85
    }, {
      "referenceID" : 27,
      "context" : "pSGLD Preconditioned SGLD (pSGLD) (Li et al., 2016a) was proposed recently to improve the mixing of SGLD.",
      "startOffset" : 34,
      "endOffset" : 52
    }, {
      "referenceID" : 41,
      "context" : "This is important for RNNs, whose parameter space often exhibits pathological curvature and saddle points (Pascanu et al., 2013), resulting in slow mixing.",
      "startOffset" : 106,
      "endOffset" : 128
    }, {
      "referenceID" : 12,
      "context" : "There are multiple choices of preconditioners; similar ideas in optimization include Adagrad (Duchi et al., 2011), Adam (Kingma and Ba, 2015) and RMSprop (Tieleman and Hinton, 2012).",
      "startOffset" : 93,
      "endOffset" : 113
    }, {
      "referenceID" : 23,
      "context" : ", 2011), Adam (Kingma and Ba, 2015) and RMSprop (Tieleman and Hinton, 2012).",
      "startOffset" : 14,
      "endOffset" : 35
    }, {
      "referenceID" : 49,
      "context" : ", 2011), Adam (Kingma and Ba, 2015) and RMSprop (Tieleman and Hinton, 2012).",
      "startOffset" : 48,
      "endOffset" : 75
    }, {
      "referenceID" : 45,
      "context" : "To further understand SG-MCMC, we show its close connection to dropout/dropConnect (Srivastava et al., 2014; Wan et al., 2013).",
      "startOffset" : 83,
      "endOffset" : 126
    }, {
      "referenceID" : 53,
      "context" : "To further understand SG-MCMC, we show its close connection to dropout/dropConnect (Srivastava et al., 2014; Wan et al., 2013).",
      "startOffset" : 83,
      "endOffset" : 126
    }, {
      "referenceID" : 54,
      "context" : "where the injected noise ξ0 can be binary-valued with dropping rate p or its equivalent Gaussian form (Wang and Manning, 2013):",
      "startOffset" : 102,
      "endOffset" : 126
    }, {
      "referenceID" : 28,
      "context" : "By combining dropConnect and Gaussian noise from the above, we have the update rule (Li et al., 2016b):",
      "startOffset" : 84,
      "endOffset" : 102
    }, {
      "referenceID" : 22,
      "context" : "• Following (Karpathy et al., 2016), we test character-level language modeling on the War and Peace (WP) novel.",
      "startOffset" : 12,
      "endOffset" : 35
    }, {
      "referenceID" : 32,
      "context" : "• The Penn Treebank (PTB) corpus (Marcus et al., 1993) is used for word-level language modeling.",
      "startOffset" : 33,
      "endOffset" : 54
    }, {
      "referenceID" : 22,
      "context" : "We study the effects of different types of architecture (LSTM/GRU/Vanilla RNN (Karpathy et al., 2016)) on the WP dataset, and effects of different learning algorithms on the PTB dataset.",
      "startOffset" : 78,
      "endOffset" : 101
    }, {
      "referenceID" : 59,
      "context" : "The results reported here do not match (Zaremba et al., 2014) due to the differences of experimental setup.",
      "startOffset" : 39,
      "endOffset" : 61
    }, {
      "referenceID" : 16,
      "context" : "We next consider the problem of image caption generation, which is a conditional RNN model, where image features are extracted by residual network (He et al., 2016), and then fed into the RNN to generate the caption.",
      "startOffset" : 147,
      "endOffset" : 164
    }, {
      "referenceID" : 20,
      "context" : "We present results on two benchmark datasets, Flickr8k (Hodosh et al., 2013) and Flickr30k (Young et al.",
      "startOffset" : 55,
      "endOffset" : 76
    }, {
      "referenceID" : 40,
      "context" : "The widely used BLEU (Papineni et al., 2002), METEOR (Banerjee and Lavie, 2005), ROUGEL (Lin, 2004), and CIDEr-D (Vedantam et al.",
      "startOffset" : 21,
      "endOffset" : 44
    }, {
      "referenceID" : 0,
      "context" : ", 2002), METEOR (Banerjee and Lavie, 2005), ROUGEL (Lin, 2004), and CIDEr-D (Vedantam et al.",
      "startOffset" : 16,
      "endOffset" : 42
    }, {
      "referenceID" : 30,
      "context" : ", 2002), METEOR (Banerjee and Lavie, 2005), ROUGEL (Lin, 2004), and CIDEr-D (Vedantam et al.",
      "startOffset" : 51,
      "endOffset" : 62
    }, {
      "referenceID" : 51,
      "context" : ", 2002), METEOR (Banerjee and Lavie, 2005), ROUGEL (Lin, 2004), and CIDEr-D (Vedantam et al., 2015) metrics are used to evaluate the performance.",
      "startOffset" : 76,
      "endOffset" : 99
    }, {
      "referenceID" : 8,
      "context" : "All the metrics are computed by using the code released by the COCO evaluation server (Chen et al., 2015b).",
      "startOffset" : 86,
      "endOffset" : 106
    }, {
      "referenceID" : 52,
      "context" : "We use the beam search approach (Vinyals et al., 2015) to generate captions, with a beam of size 5.",
      "startOffset" : 32,
      "endOffset" : 54
    }, {
      "referenceID" : 25,
      "context" : "We study the task of sentence classification on 5 datasets as in (Kiros et al., 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al.",
      "startOffset" : 65,
      "endOffset" : 85
    }, {
      "referenceID" : 29,
      "context" : ", 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al.",
      "startOffset" : 14,
      "endOffset" : 33
    }, {
      "referenceID" : 39,
      "context" : ", 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al.",
      "startOffset" : 38,
      "endOffset" : 58
    }, {
      "referenceID" : 38,
      "context" : ", 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al.",
      "startOffset" : 65,
      "endOffset" : 85
    }, {
      "referenceID" : 21,
      "context" : ", 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al.",
      "startOffset" : 90,
      "endOffset" : 108
    }, {
      "referenceID" : 57,
      "context" : ", 2015): TREC (Li and Roth, 2002), MR (Pang and Lee, 2005), SUBJ (Pang and Lee, 2004), CR (Hu and Liu, 2004) and MPQA (Wiebe et al., 2005).",
      "startOffset" : 118,
      "endOffset" : 138
    }, {
      "referenceID" : 14,
      "context" : "In addition to (naive) dropout, we further compare pSGLD with the Gal’s dropout, recently proposed in (Gal and Ghahramani, 2016b), which is shown to be applicable to recurrent layers.",
      "startOffset" : 102,
      "endOffset" : 129
    }, {
      "referenceID" : 26,
      "context" : "Future works include improving the testing efficiency for the large-scale RNNs, via learning a single neural network that approximates the model averaging result (Korattikara et al., 2015).",
      "startOffset" : 162,
      "endOffset" : 188
    } ],
    "year" : 0,
    "abstractText" : "Recurrent neural networks (RNNs) have shown promising performance for language modeling. However, traditional training of RNNs using back-propagation through time often suffers from overfitting. One reason for this is that stochastic optimization (used for large training sets) does not provide good estimates of model uncertainty. This paper leverages recent advances in stochastic gradient Markov Chain Monte Carlo (also appropriate for large training sets) to learn weight uncertainty in RNNs. It yields a principled Bayesian learning algorithm, adding gradient noise during training (enhancing exploration of the model-parameter space) and model averaging when testing. Extensive experiments on various RNN models and across a broad range of applications demonstrate the superiority of the proposed approach relative to stochastic optimization.",
    "creator" : null
  }
}